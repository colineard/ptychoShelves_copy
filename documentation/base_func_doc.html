

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>base package documentation &mdash; PtychoShelves  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ptycho package documentation" href="ptycho_func_doc.html" />
    <link rel="prev" title="How to add support for a beamline" href="new_beamline.html" />
    <link href="_static/mod_theme.css" rel="stylesheet" type="text/css">


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PtychoShelves
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">PtychoShelves</a></li>
<li class="toctree-l1"><a class="reference internal" href="template_ptycho.html">template_ptycho - your virtual control room</a></li>
<li class="toctree-l1"><a class="reference internal" href="new_beamline.html">How to add support for a beamline</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">base package documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#astra">+astra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#astra-astra-gpu-wrapper">+astra/ASTRA_GPU_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="#astra-astra-gpu-wrapper-astra">+astra/ASTRA_GPU_wrapper/astra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#astra-private">+astra/private</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beamline">+beamline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#beamline-private">+beamline/private</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fluo">+fluo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fluo-private">+fluo/private</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#io">+io</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#io-cbf">+io/+CBF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#io-hdf">+io/+HDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#io-hdf-private">+io/+HDF/private</a></li>
<li class="toctree-l3"><a class="reference internal" href="#io-private">+io/private</a></li>
<li class="toctree-l3"><a class="reference internal" href="#io-private-ptycho-reader">+io/private/ptycho_reader</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#math">+math</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotting">+plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utils">+utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#utils-private">+utils/private</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#trash">trash</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ptycho_func_doc.html">ptycho package documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ptycho_license.html">Academic License Agreement</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PtychoShelves</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>base package documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/base_func_doc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="base-package-documentation">
<h1>base package documentation<a class="headerlink" href="#base-package-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<dl class="object">
<dt>
<code class="descname">check_beamtime_status</code></dt>
<dd><div class="line-block">
<div class="line">check_beamtime_status is a script.</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">find_dependencies</code></dt>
<dd><div class="line-block">
<div class="line">find_dependencies is a script.</div>
</div>
</dd></dl>

<div class="section" id="astra">
<h2>+astra<a class="headerlink" href="#astra" title="Permalink to this headline">¶</a></h2>
<span class="target" id="base-astra-astra-find-optimal-split"></span><dl class="function">
<dt id="astra.ASTRA_find_optimal_split">
<code class="descclassname">astra.</code><code class="descname">ASTRA_find_optimal_split</code><span class="sig-paren">(</span><em>cfg</em>, <em>num_gpu</em>, <em>angle_blocks</em>, <em>propagator</em><span class="sig-paren">)</span><a class="headerlink" href="#astra.ASTRA_find_optimal_split" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">split = ASTRA_find_optimal_split(cfg, num_gpu, angle_blocks, propagator)</div>
<div class="line">FUNCTION Find optimal split of data and make the blocks sufficiniently small for</div>
<div class="line">limited GPU memory</div>
<div class="line">Inputs:</div>
<div class="line">cfg - config structure generated by ASTRA_initialize</div>
<div class="line">num_gpu - number of gpu to split the data</div>
<div class="line">angle_blocks - number of angular blocks (ie in SART method or FSC)</div>
<div class="line">propagator - which propagator should be assumed : FWD, BACK, both (default)</div>
<div class="line">Outputs:</div>
<div class="line">split - volume / angle split - [split_x,split_y,split_z,split_angles]</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">split</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">ASTRA_initialize</code></dt>
<dd><div class="line-block">
<div class="line">[cfg, vectors] = ASTRA_initialize(Npix, size_projection,angles,lamino_angle, tilt_angle, pixel_scale, rotation_center)</div>
<div class="line">FUNCTION Generate configs needed for astra, all angles are expected in degress</div>
<div class="line">Inputs:</div>
<div class="line">Npix - size of tomogram</div>
<div class="line">size_projection - size of sinogram (Nlayers, width, Nangles)</div>
<div class="line">angles - rotation angles of projections in degrees</div>
<div class="line">lamino_angle - laminography angle / angles in degrees. lamino_angle ==</div>
<div class="line">90 is standard tomography , default = 90</div>
<div class="line">tilt_angle - tilt of camera with respect to the rotation axis coordinates, in</div>
<div class="line">degrees, default = 0</div>
<div class="line">pixel_scale - scale of pixels in tomogram compares to the</div>
<div class="line">projection pixel size, default = 1</div>
<div class="line">rotation_center - center of rotation cooridinates, default = size_projection/2</div>
</div>
</dd></dl>

<span class="target" id="base-astra-atx-partial"></span><dl class="function">
<dt id="astra.Atx_partial">
<code class="descclassname">astra.</code><code class="descname">Atx_partial</code><span class="sig-paren">(</span><em>projData</em>, <em>cfg</em>, <em>vectors</em>, <em>split</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#astra.Atx_partial" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">vol_full = Atx_partial(projData, cfg, vectors,split,varargin)</div>
<div class="line">FUNCTION backprojector that allows to split the full volume into smaller pieces</div>
<div class="line">composed tomography back-projector based on ASTRA toolbox</div>
<div class="line">can be used either for data in RAM or on GPU (automatically decided from class of volData)</div>
<div class="line">* volume is split based on “split” parameter, 1 == no splitting</div>
<div class="line">* Atx_partial tries to split data if GPU limits are exceeded (ie texture memory limits)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">vol_full</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-astra-ax-partial"></span><dl class="function">
<dt id="astra.Ax_partial">
<code class="descclassname">astra.</code><code class="descname">Ax_partial</code><span class="sig-paren">(</span><em>volData</em>, <em>cfg</em>, <em>vectors</em>, <em>split</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#astra.Ax_partial" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">projData = Ax_partial(volData, cfg, vectors,split, varargin)</div>
<div class="line">FUNCTION  forward projector that allows to split the full volume into smaller pieces</div>
<div class="line">Inputs:</div>
<div class="line">composed tomography projector based on ASTRA toolbox</div>
<div class="line">can be used either for data in RAM or on GPU (automatically decided from class of volData)</div>
<div class="line">* volume is split based on “split” parameter, 1 == no splitting</div>
<div class="line">* Ax_partial tries to split data if GPU limits are exceeded (ie texture memory limits)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">projData</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">example</code></dt>
<dd><div class="line-block">
<div class="line">example script for ASTRA wrappers</div>
<div class="line">recompile commands</div>
<div class="line">(Linux, GCC 4.8.5)   mexcuda -outdir private  ASTRA_GPU_wrapper/ASTRA_GPU_wrapper.cu ASTRA_GPU_wrapper/util3d.cu ASTRA_GPU_wrapper/par3d_fp.cu ASTRA_GPU_wrapper/par3d_bp.cu</div>
<div class="line">(Windows)  mexcuda -outdir private  ASTRA_GPU_wrapper.. _base_astra.iradon_gpu_wrapper:</div>
</div>
</dd></dl>

<dl class="function">
<dt id="astra.iradon_gpu_wrapper">
<code class="descclassname">astra.</code><code class="descname">iradon_gpu_wrapper</code><span class="sig-paren">(</span><em>sinogram</em>, <em>cfg</em>, <em>vectors</em><span class="sig-paren">)</span><a class="headerlink" href="#astra.iradon_gpu_wrapper" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">vol = iradon_gpu_wrapper(sinogram, cfg, vectors)</div>
<div class="line">FUNCTION  back projector that allows to split the full volume into smaller pieces</div>
<div class="line">Inputs:</div>
<div class="line">composed tomography projector based on ASTRA toolbox</div>
<div class="line">can be used either for data in RAM or on GPU (automatically decided from class of volData)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">vol</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="astra-astra-gpu-wrapper">
<h3>+astra/ASTRA_GPU_wrapper<a class="headerlink" href="#astra-astra-gpu-wrapper" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="astra-astra-gpu-wrapper-astra">
<h3>+astra/ASTRA_GPU_wrapper/astra<a class="headerlink" href="#astra-astra-gpu-wrapper-astra" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="astra-private">
<h3>+astra/private<a class="headerlink" href="#astra-private" title="Permalink to this headline">¶</a></h3>
<span class="target" id="base-astra-add-to-3d"></span><dl class="function">
<dt id="astra.add_to_3D">
<code class="descclassname">astra.</code><code class="descname">add_to_3D</code><span class="sig-paren">(</span><em>full_array</em>, <em>small_array</em>, <em>position</em><span class="sig-paren">)</span><a class="headerlink" href="#astra.add_to_3D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION full_array = add_to_3D(full_array, small_array, position)</div>
<div class="line">add one small 3D block into large 3D array</div>
<div class="line">Inputs:</div>
<div class="line">full_array</div>
<div class="line">small_array</div>
<div class="line">position - offset from (1,1,1) coordinate in pixels</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">full_array</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-astra-astra2matlab"></span><dl class="function">
<dt id="astra.astra2matlab">
<code class="descclassname">astra.</code><code class="descname">astra2matlab</code><span class="sig-paren">(</span><em>sinogram</em><span class="sig-paren">)</span><a class="headerlink" href="#astra.astra2matlab" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION sinogram = astra2matlab(sinogram)</div>
<div class="line">simple function to reshape sinogram from ASTRA (C++) order to Matlab (FORTRAN)  order</div>
<div class="line">Inputs:</div>
<div class="line">sinogram - real value sinogram</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sinogram</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-astra-matlab2astra"></span><dl class="function">
<dt id="astra.matlab2astra">
<code class="descclassname">astra.</code><code class="descname">matlab2astra</code><span class="sig-paren">(</span><em>sinogram</em><span class="sig-paren">)</span><a class="headerlink" href="#astra.matlab2astra" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION sinogram = astra2matlab(sinogram)</div>
<div class="line">simple function to reshape sinogram from Matlab (FORTRAN) order to ASTRA (C++) order</div>
<div class="line">Inputs:</div>
<div class="line">sinogram - real value sinogram</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sinogram</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="beamline">
<h2>+beamline<a class="headerlink" href="#beamline" title="Permalink to this headline">¶</a></h2>
<span class="target" id="base-beamline-omny-get-scan-numbers"></span><dl class="function">
<dt id="beamline.OMNY_get_scan_numbers">
<code class="descclassname">beamline.</code><code class="descname">OMNY_get_scan_numbers</code><span class="sig-paren">(</span><em>OMNY_angles_file</em>, <em>tomo_id</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.OMNY_get_scan_numbers" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">OMNY_get_scan_numbers( OMNY_angles_file, scannums )</div>
<div class="line">OMNY_angles_file  -  File with Scan number, angle target, angle readout</div>
<div class="line">tomo_id           -  Index specifying the range of scan numbers</div>
</div>
<div class="line-block">
<div class="line">out               - returns scan numbers for tomo_id</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-beamstop-mask"></span><dl class="function">
<dt id="beamline.beamstop_mask">
<code class="descclassname">beamline.</code><code class="descname">beamstop_mask</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.beamstop_mask" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bmask_ind</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-choose-beamstop-mask"></span><dl class="function">
<dt id="beamline.choose_beamstop_mask">
<code class="descclassname">beamline.</code><code class="descname">choose_beamstop_mask</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.choose_beamstop_mask" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[mask_coord,bmask_ind] = choose_beamstop_mask(filename,varargin)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mask_coord, bmask_ind</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-create-mask"></span><dl class="function">
<dt id="beamline.create_mask">
<code class="descclassname">beamline.</code><code class="descname">create_mask</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.create_mask" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">CREATE_MASK</div>
<div class="line">create a binary mask for the current figure</div>
</div>
<div class="line-block">
<div class="line"><em>optional</em></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mask</strong> – initial mask; either a file, an array or a structure (indicies + asize)</li>
<li><strong>fig</strong> – pass figure handle; default: current figure</li>
<li><strong>ind</strong> – convert mask to indicies</li>
<li><strong>file</strong> – save mask to disk; specify path + filename</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>out</strong> - 2D binary mask or structure containing the asize and the indicies</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">see also <a class="reference internal" href="#base-beamline-mask2ind"><span class="std std-ref">beamline.mask2ind</span></a></div>
</div>
</dd></dl>

<span class="target" id="base-beamline-energy2mark"></span><dl class="function">
<dt id="beamline.energy2mark">
<code class="descclassname">beamline.</code><code class="descname">energy2mark</code><span class="sig-paren">(</span><em>E</em>, <em>calib_file</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.energy2mark" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function mark = energy2mark(E,calib_file)</div>
<div class="line">After calibrating using beamline.mark_interpolation_setup you can use</div>
<div class="line">this function to input a desired energy and a linear interpolation will</div>
<div class="line">determine and give you the mark</div>
<div class="line">Inputs</div>
<div class="line">E            Array of energies in keV</div>
<div class="line">calib_file   Name of the file with the calibration</div>
</div>
<div class="line-block">
<div class="line">Outputs</div>
<div class="line">mark         Array of marks corresponding to input energies</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mark</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-find-capillary"></span><dl class="function">
<dt id="beamline.find_capillary">
<code class="descclassname">beamline.</code><code class="descname">find_capillary</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.find_capillary" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[varargout] = find_capillary(varargin)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">find_capillary_wrapper</code></dt>
<dd><div class="line-block">
<div class="line">this script contains the necessary loop for ‘find_capillary.m’ to be called</div>
<div class="line">as function of ‘spec’</div>
<div class="line">written by  (last change: 2011-06-16)</div>
<div class="line">in case of bugs, problems, and suggestions for improvements, please contact</div>
<div class="line">CXS group</div>
</div>
<div class="line-block">
<div class="line">note that EPICS communication works only on local machines at the beamline, i.e.,</div>
<div class="line">NOT on the compute nodes</div>
<div class="line">run this (or related scripts that use EPICS for communication), for instance, on</div>
<div class="line">x12sa-cons-1</div>
</div>
</dd></dl>

<span class="target" id="base-beamline-find-specdatfile"></span><dl class="function">
<dt id="beamline.find_specDatFile">
<code class="descclassname">beamline.</code><code class="descname">find_specDatFile</code><span class="sig-paren">(</span><em>specDatFile</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.find_specDatFile" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function specDatFile = find_specDatFile(specDatFile)</div>
<div class="line">find location of the spec file in the provided folder / path</div>
<div class="line">if the variable specDatFile is not a complete path to a file</div>
<div class="line">try to guess where a spec data file can be found, by</div>
<div class="line">- look for directories called ‘spec’ or ‘dat-files’</div>
<div class="line">- look for files called ‘<a href="#id1"><span class="problematic" id="id2">*</span></a>.dat’</div>
<div class="line">- take the newest one</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">specDatFile</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">flux_estimate</code></dt>
<dd><div class="line-block">
<div class="line">beamline.flux_estimate is a script.</div>
</div>
</dd></dl>

<span class="target" id="base-beamline-identify-eaccount"></span><dl class="function">
<dt id="beamline.identify_eaccount">
<code class="descclassname">beamline.</code><code class="descname">identify_eaccount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#beamline.identify_eaccount" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">at the X12SA beamline, [] otherwise.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">return_user_name</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-ind2mask"></span><dl class="function">
<dt id="beamline.ind2mask">
<code class="descclassname">beamline.</code><code class="descname">ind2mask</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.ind2mask" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">IND2MASK</div>
<div class="line">convert mask structure (indices + framesize) to a 2D binary mask</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> – mask structure; must contain s.indices and s.framesize</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>mask</strong> - 2D binary mask</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">see also <a class="reference internal" href="#base-beamline-mask2ind"><span class="std std-ref">beamline.mask2ind</span></a></div>
</div>
</dd></dl>

<span class="target" id="base-beamline-integrate-range"></span><dl class="function">
<dt id="beamline.integrate_range">
<code class="descclassname">beamline.</code><code class="descname">integrate_range</code><span class="sig-paren">(</span><em>scan_no_from</em>, <em>scan_no_to</em>, <em>scan_no_step</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.integrate_range" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
</dd></dl>

<span class="target" id="base-beamline-intensity-calibration"></span><dl class="function">
<dt id="beamline.intensity_calibration">
<code class="descclassname">beamline.</code><code class="descname">intensity_calibration</code><span class="sig-paren">(</span><em>specfile</em>, <em>air_scanno</em>, <em>gc_scanno</em>, <em>det_dist_mm</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.intensity_calibration" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Description:</div>
</div>
<div class="line-block">
<div class="line">a glassy carbon sample and and air</div>
</div>
<div class="line-block">
<div class="line">Dependencies:</div>
<div class="line">spec_read</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">diodescale</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-is-scan-finished"></span><dl class="function">
<dt id="beamline.is_scan_finished">
<code class="descclassname">beamline.</code><code class="descname">is_scan_finished</code><span class="sig-paren">(</span><em>specDatFile</em>, <em>scanno</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.is_scan_finished" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">out = is_scan_finished(specDatFile,scanno)</div>
<div class="line">Detect ‘X# ‘ in spec file to detect the end of a scan</div>
<div class="line">From spec compile  post_scan.mac</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-is-scan-started"></span><dl class="function">
<dt id="beamline.is_scan_started">
<code class="descclassname">beamline.</code><code class="descname">is_scan_started</code><span class="sig-paren">(</span><em>specDatFile</em>, <em>scanno</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.is_scan_started" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">out = is_scan_started(specDatFile,scanno)</div>
<div class="line">Detect ‘X# ‘ in spec file to detect the end of a scan</div>
<div class="line">From spec compile  post_scan.mac</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">mark_interpolation_setup</code></dt>
<dd><div class="line-block">
<div class="line">If you do scans with different marks for energy you can use this code to</div>
<div class="line">calibrate the marks vs energy</div>
<div class="line">Run this code, it will save a calibration and then you can use</div>
<div class="line">energy2mark function</div>
</div>
</dd></dl>

<span class="target" id="base-beamline-mask2ind"></span><dl class="function">
<dt id="beamline.mask2ind">
<code class="descclassname">beamline.</code><code class="descname">mask2ind</code><span class="sig-paren">(</span><em>mask</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.mask2ind" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">MASK2IND</div>
<div class="line">convert a 2D binary mask to indices</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mask</strong> – 2D binary mask</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>s</strong> - mask structure; must contain s.indices and s.framesize</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">see also <a class="reference internal" href="#base-beamline-ind2mask"><span class="std std-ref">beamline.ind2mask</span></a></div>
</div>
</dd></dl>

<span class="target" id="base-beamline-pilatus-valid-pixel-roi"></span><dl class="function">
<dt id="beamline.pilatus_valid_pixel_roi">
<code class="descclassname">beamline.</code><code class="descname">pilatus_valid_pixel_roi</code><span class="sig-paren">(</span><em>valid_mask</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.pilatus_valid_pixel_roi" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">valid_mask</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-prep-integ-masks"></span><dl class="function">
<dt id="beamline.prep_integ_masks">
<code class="descclassname">beamline.</code><code class="descname">prep_integ_masks</code><span class="sig-paren">(</span><em>filename</em>, <em>center_xy</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.prep_integ_masks" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">integ_masks</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-prep-valid-mask"></span><dl class="function">
<dt id="beamline.prep_valid_mask">
<code class="descclassname">beamline.</code><code class="descname">prep_valid_mask</code><span class="sig-paren">(</span><em>data_dir</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.prep_valid_mask" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">valid_mask</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-radial-integ"></span><dl class="function">
<dt id="beamline.radial_integ">
<code class="descclassname">beamline.</code><code class="descname">radial_integ</code><span class="sig-paren">(</span><em>filename_masks</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.radial_integ" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">I, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">radial_integration_SAXS_and_WAXS</code></dt>
<dd><div class="line-block">
<div class="line">radial_integration_SAXS_and_WAXS.m</div>
<div class="line">Template for radial integration made around 2015</div>
<div class="line">Changes:</div>
<div class="line">2016-08-22: define mask files at the beginning, allowing for a flag in case it needs to be repeated</div>
<div class="line">add the save fast and v6</div>
</div>
</dd></dl>

<span class="target" id="base-beamline-read-omny-angles"></span><dl class="function">
<dt id="beamline.read_omny_angles">
<code class="descclassname">beamline.</code><code class="descname">read_omny_angles</code><span class="sig-paren">(</span><em>OMNY_angles_file</em>, <em>scannums</em>, <em>tomo_id</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.read_omny_angles" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">read_omny_angles( OMNY_angles_file, scannums, tomo_id )</div>
<div class="line">OMNY_angles_file  -  File with Scan number, angle target, angle readout</div>
<div class="line">scannums          -  Array of scan numbers</div>
<div class="line">tomo_id           -  integer or list of integers, only if the scannums is empty</div>
</div>
<div class="line-block">
<div class="line">out               - Contains fields with scan, target_angle, readout_angle</div>
<div class="line">errorflag         - = 1 if at least one scan was not found</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out errorflag</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-read-omny-pos"></span><dl class="function">
<dt id="beamline.read_omny_pos">
<code class="descclassname">beamline.</code><code class="descname">read_omny_pos</code><span class="sig-paren">(</span><em>omnyposfile</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.read_omny_pos" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Read interferometer positions written by Orchestra</div>
<div class="line">Input is the filename with path</div>
<div class="line">Output is a structure containing fields:</div>
<div class="line">The two values of the one line header originally ‘Scan’ and ‘Samroy’</div>
<div class="line">Values for each point of 10 expected columns of numbers</div>
<div class="line">12 June 2013</div>
<div class="line">June6 2015 - Changed in order to accept an arbitrary number</div>
<div class="line">of values in order to be compatible with 10 columns for flOMNI and 19 for</div>
<div class="line">OMNY</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">struct_out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-beamline-stxm-online"></span><dl class="function">
<dt id="beamline.stxm_online">
<code class="descclassname">beamline.</code><code class="descname">stxm_online</code><span class="sig-paren">(</span><em>first_scan_number</em>, <em>Ny</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.stxm_online" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">template_stxm_online_cont_dmesh</code></dt>
<dd><div class="line-block">
<div class="line">beamline.template_stxm_online_cont_dmesh is a script.</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">template_stxm_online_mesh</code></dt>
<dd><div class="line-block">
<div class="line">beamline.template_stxm_online_mesh is a script.</div>
</div>
</dd></dl>

<span class="target" id="base-beamline-tune-valid-mask"></span><dl class="function">
<dt id="beamline.tune_valid_mask">
<code class="descclassname">beamline.</code><code class="descname">tune_valid_mask</code><span class="sig-paren">(</span><em>data_dir</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.tune_valid_mask" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">valid_mask</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="beamline-private">
<h3>+beamline/private<a class="headerlink" href="#beamline-private" title="Permalink to this headline">¶</a></h3>
<span class="target" id="base-beamline-create-mask-gui-export"></span><dl class="function">
<dt id="beamline.create_mask_GUI_export">
<code class="descclassname">beamline.</code><code class="descname">create_mask_GUI_export</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#beamline.create_mask_GUI_export" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">CREATE_MASK_GUI_EXPORT MATLAB code for create_mask_GUI_export.fig</div>
<div class="line">CREATE_MASK_GUI_EXPORT, by itself, creates a new CREATE_MASK_GUI_EXPORT or raises the existing</div>
<div class="line">singleton*.</div>
</div>
<div class="line-block">
<div class="line">H = CREATE_MASK_GUI_EXPORT returns the handle to a new CREATE_MASK_GUI_EXPORT or the handle to</div>
<div class="line">the existing singleton*.</div>
</div>
<div class="line-block">
<div class="line">CREATE_MASK_GUI_EXPORT(‘CALLBACK’,hObject,eventData,handles,…) calls the local</div>
<div class="line">function named CALLBACK in CREATE_MASK_GUI_EXPORT.M with the given input arguments.</div>
</div>
<div class="line-block">
<div class="line">CREATE_MASK_GUI_EXPORT(‘Property’,’Value’,…) creates a new CREATE_MASK_GUI_EXPORT or raises the</div>
<div class="line">existing singleton*.  Starting from the left, property value pairs are</div>
<div class="line">applied to the GUI before create_mask_GUI_export_OpeningFcn gets called.  An</div>
<div class="line">unrecognized property name or invalid value makes property application</div>
<div class="line">stop.  All inputs are passed to create_mask_GUI_export_OpeningFcn via varargin.</div>
</div>
<div class="line-block">
<div class="line"><a href="#id3"><span class="problematic" id="id4">*</span></a>See GUI Options on GUIDE’s Tools menu.  Choose “GUI allows only one</div>
<div class="line">instance to run (singleton)”.</div>
</div>
<div class="line-block">
<div class="line">See also: GUIDE, GUIDATA, GUIHANDLES</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="fluo">
<h2>+fluo<a class="headerlink" href="#fluo" title="Permalink to this headline">¶</a></h2>
<dl class="object">
<dt>
<code class="descname">fluorescence_data</code></dt>
<dd><div class="line-block">
<div class="line">% A template to plot fluorescence data %%%</div>
<div class="line">%% mcs_mesh.m could be upgraded to do this job, but here is a script in</div>
<div class="line">%% the meantime</div>
<div class="line">%% Feb 24, 2016</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">fluorescence_deconv</code></dt>
<dd><div class="line-block">
<div class="line">Deconvolution with specified scanning positions</div>
<div class="line">2017-03</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">fluorescence_plot_fermat</code></dt>
<dd><div class="line-block">
<div class="line">% A template to plot fluorescence data %%%</div>
<div class="line">%% mcs_mesh.m could be upgraded to do this job, but here is a script in</div>
<div class="line">%% the meantime</div>
<div class="line">%% Feb 24, 2016</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">fluorescence_save_projections</code></dt>
<dd><div class="line-block">
<div class="line">% A template to plot fluorescence data %%%</div>
<div class="line">%% mcs_mesh.m could be upgraded to do this job, but here is a script in</div>
<div class="line">%% the meantime</div>
<div class="line">%% Manuel Guizar, Feb 24, 2016</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">fluorescence_tomo_lowres</code></dt>
<dd><div class="line-block">
<div class="line">fluo.fluorescence_tomo_lowres is a script.</div>
</div>
</dd></dl>

<div class="section" id="fluo-private">
<h3>+fluo/private<a class="headerlink" href="#fluo-private" title="Permalink to this headline">¶</a></h3>
<span class="target" id="base-fluo-geom-mat-blur"></span><dl class="function">
<dt id="fluo.geom_mat_blur">
<code class="descclassname">fluo.</code><code class="descname">geom_mat_blur</code><span class="sig-paren">(</span><em>Np</em>, <em>kernel</em><span class="sig-paren">)</span><a class="headerlink" href="#fluo.geom_mat_blur" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION T = geom_mat_blur(Np, kernel)</div>
<div class="line">generates a sparse matrix that emulates convolution with given kernel</div>
<div class="line">Example conv2(img,ker,’same’) is same as reshape(T*img(:), Npix)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">T</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-fluo-geom-mat-simpler"></span><dl class="function">
<dt id="fluo.geom_mat_simpler">
<code class="descclassname">fluo.</code><code class="descname">geom_mat_simpler</code><span class="sig-paren">(</span><em>Npix</em>, <em>positions</em>, <em>weights</em><span class="sig-paren">)</span><a class="headerlink" href="#fluo.geom_mat_simpler" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION T =  geom_mat_simpler(Npix, positions, weights, varargin)</div>
<div class="line">creates a sparse matrix that will cause shift of the vector into</div>
<div class="line">given positions</div>
<div class="line">example:</div>
<div class="line">img = imread(‘cameraman’)</div>
<div class="line">T*img(:)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">T</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-fluo-repeat"></span><dl class="function">
<dt id="fluo.repeat">
<code class="descclassname">fluo.</code><code class="descname">repeat</code><span class="sig-paren">(</span><em>x</em>, <em>N</em>, <em>ax</em><span class="sig-paren">)</span><a class="headerlink" href="#fluo.repeat" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">— help for repmat —</div>
<div class="line">REPMAT Replicate and tile an array.</div>
<div class="line">B = REPMAT(A,M,N) or B = REPMAT(A,[M,N]) creates a large matrix B</div>
<div class="line">consisting of an M-by-N tiling of copies of A. If A is a matrix,</div>
<div class="line">the size of B is [size(A,1)*M, size(A,2)*N].</div>
</div>
<div class="line-block">
<div class="line">B = REPMAT(A,N) creates an N-by-N tiling.</div>
</div>
<div class="line-block">
<div class="line">B = REPMAT(A,P1,P2,…,Pn) or B = REPMAT(A,[P1,P2,…,Pn]) tiles the array</div>
<div class="line">A to produce an n-dimensional array B composed of copies of A. The size</div>
<div class="line">of B is [size(A,1)*P1, size(A,2)*P2, …, size(A,n)*Pn].</div>
<div class="line">If A is m-dimensional with m &gt; n, an m-dimensional array B is returned.</div>
<div class="line">In this case, the size of B is [size(A,1)*P1, size(A,2)*P2, …,</div>
<div class="line">size(A,n)*Pn, size(A, n+1), …, size(A, m)].</div>
</div>
<div class="line-block">
<div class="line">REPMAT(A,M,N) when A is a scalar is commonly used to produce an M-by-N</div>
<div class="line">matrix filled with A’s value and having A’s CLASS. For certain values,</div>
<div class="line">you may achieve the same results using other functions. Namely,</div>
<div class="line">REPMAT(NAN,M,N)           is the same as   NAN(M,N)</div>
<div class="line">REPMAT(SINGLE(INF),M,N)   is the same as   INF(M,N,’single’)</div>
<div class="line">REPMAT(INT8(0),M,N)       is the same as   ZEROS(M,N,’int8’)</div>
<div class="line">REPMAT(UINT32(1),M,N)     is the same as   ONES(M,N,’uint32’)</div>
<div class="line">REPMAT(EPS,M,N)           is the same as   EPS(ONES(M,N))</div>
</div>
<div class="line-block">
<div class="line">Example:</div>
<div class="line">repmat(magic(2), 2, 3)</div>
<div class="line">repmat(uint8(5), 2, 3)</div>
</div>
<div class="line-block">
<div class="line">Class support for input A:</div>
<div class="line">float: double, single</div>
<div class="line">integer: uint8, int8, uint16, int16, uint32, int32, uint64, int64</div>
<div class="line">char, logical</div>
</div>
<div class="line-block">
<div class="line">See also BSXFUN, MESHGRID, ONES, ZEROS, NAN, INF.</div>
<div class="line">Reference page in Doc Center</div>
<div class="line">doc repmat</div>
<div class="line">Other functions named repmat</div>
<div class="line">codistributed/repmat    InputOutputModel/repmat    tall/repmat</div>
<div class="line">gpuArray/repmat         symfun/repmat</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x_new</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-fluo-replicate"></span><dl class="function">
<dt id="fluo.replicate">
<code class="descclassname">fluo.</code><code class="descname">replicate</code><span class="sig-paren">(</span><em>x</em>, <em>N</em>, <em>ax</em><span class="sig-paren">)</span><a class="headerlink" href="#fluo.replicate" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">fast replitaction of matrix along one dimension, faster than</div>
<div class="line">repmat / kron</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x_new</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="io">
<h2>+io<a class="headerlink" href="#io" title="Permalink to this headline">¶</a></h2>
<span class="target" id="base-io-common-header-value"></span><dl class="function">
<dt id="io.common_header_value">
<code class="descclassname">io.</code><code class="descname">common_header_value</code><span class="sig-paren">(</span><em>header</em>, <em>extension</em>, <em>signature</em><span class="sig-paren">)</span><a class="headerlink" href="#io.common_header_value" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">value</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-datread"></span><dl class="function">
<dt id="io.datread">
<code class="descclassname">io.</code><code class="descname">datread</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.datread" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frame, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-edfread"></span><dl class="function">
<dt id="io.edfread">
<code class="descclassname">io.</code><code class="descname">edfread</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.edfread" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frame, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">export_for_SASfit</code></dt>
<dd><div class="line-block">
<div class="line">This script is to plot, correct and export solution SAXS data to SASfit</div>
<div class="line">accounts for transmission, time and thickness correction</div>
<div class="line">scales the data to a calibration factor</div>
<div class="line">background correction, removal of bad pixels</div>
<div class="line">not suitable for anisotropic data</div>
<div class="line">saves the output to be used in SASfit</div>
</div>
</dd></dl>

<span class="target" id="base-io-fliread"></span><dl class="function">
<dt id="io.fliread">
<code class="descclassname">io.</code><code class="descname">fliread</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.fliread" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frame, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">image_default_orientation</code></dt>
<dd><div class="line-block">
<div class="line">[orient_vec] = image_default_orientation(header, extension, varargin)</div>
<div class="line">Determine default orientation for an image_orient.m call based on the</div>
<div class="line">file extension</div>
</div>
</dd></dl>

<span class="target" id="base-io-image-info"></span><dl class="function">
<dt id="io.image_info">
<code class="descclassname">io.</code><code class="descname">image_info</code><span class="sig-paren">(</span><em>filenames</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.image_info" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[im_info,vararg_remain] = image_info(filenames,varargin)</div>
<div class="line">Get information like the dimensions of the data stored in an image file</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">im_info, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-image-orient"></span><dl class="function">
<dt id="io.image_orient">
<code class="descclassname">io.</code><code class="descname">image_orient</code><span class="sig-paren">(</span><em>frame</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.image_orient" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frame_out, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-image-read"></span><dl class="function">
<dt id="io.image_read">
<code class="descclassname">io.</code><code class="descname">image_read</code><span class="sig-paren">(</span><em>filenames</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.image_read" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frames, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-image-read-help"></span><dl class="function">
<dt id="io.image_read_help">
<code class="descclassname">io.</code><code class="descname">image_read_help</code><span class="sig-paren">(</span><em>extension</em>, <em>m_file_name</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.image_read_help" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">image_read_help(extension,m_file_name,varargin)</div>
<div class="line">parameter help for image_read</div>
</div>
</dd></dl>

<span class="target" id="base-io-json2mat"></span><dl class="function">
<dt id="io.json2mat">
<code class="descclassname">io.</code><code class="descname">json2mat</code><span class="sig-paren">(</span><em>J</em><span class="sig-paren">)</span><a class="headerlink" href="#io.json2mat" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">io.json2mat is a function.</div>
<div class="line">M = json2mat(J)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">M</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-load-prepared-data"></span><dl class="function">
<dt id="io.load_prepared_data">
<code class="descclassname">io.</code><code class="descname">load_prepared_data</code><span class="sig-paren">(</span><em>filename</em>, <em>return_intensity</em>, <em>enum</em>, <em>return_fftshifted</em><span class="sig-paren">)</span><a class="headerlink" href="#io.load_prepared_data" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">LOAD_PREPARED_DATA Load prepared data file and convert it into the default Matlab</div>
<div class="line">structure</div>
</div>
<div class="line-block">
<div class="line">filename…             path and filename of the h5 file</div>
</div>
<div class="line-block">
<div class="line"><em>optional</em></div>
</div>
<div class="line-block">
<div class="line">scan…                 select scan, either integer or array</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">fmag, fmask, pos, max_power, scanindexrange</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-load-ptycho-recons"></span><dl class="function">
<dt id="io.load_ptycho_recons">
<code class="descclassname">io.</code><code class="descname">load_ptycho_recons</code><span class="sig-paren">(</span><em>filename_with_path</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.load_ptycho_recons" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">LOAD_PTYCHO_RECONS Load data from cxs/h5 or mat file and return it as</div>
<div class="line">structure, single dataset or directly into the workspace.</div>
<div class="line">An additional argument can be passed to select subsections of the data.</div>
<div class="line">Loading single datasets is only supported for at least 2 output</div>
<div class="line">arguments.</div>
</div>
<div class="line-block">
<div class="line">file…     path to cxs/h5 or mat file</div>
</div>
<div class="line-block">
<div class="line"><em>optional</em></div>
<div class="line">section…  ‘full’, ‘probe’, ‘object’, ‘recon’ or ‘p’ to select</div>
<div class="line">subsections of the data; default: ‘full’</div>
</div>
<div class="line-block">
<div class="line">EXAMPLES:</div>
<div class="line">%% recommended usage %%</div>
<div class="line">% load into a structure</div>
<div class="line">S = load_ptycho_recons(‘./recon.h5’);</div>
</div>
<div class="line-block">
<div class="line">% load a subset</div>
<div class="line">S = load_ptycho_recons(‘./recon.h5’, ‘probe’);</div>
</div>
<div class="line-block">
<div class="line">% load into single datasets</div>
<div class="line">[object, probe, p] = load_ptycho_recons(‘./recon.h5’);</div>
</div>
<div class="line-block">
<div class="line">%% not recommended, only works in ‘base’ workspace %%</div>
<div class="line">% load directly into workspace</div>
<div class="line">load_ptycho_recons(‘./recon.h5’);</div>
</div>
<div class="line-block">
<div class="line">full = object, probe (current scan) and p</div>
<div class="line">recon = object and probe (current scan)</div>
<div class="line">probe = probe (current scan)</div>
<div class="line">object = object (current scan)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-marread"></span><dl class="function">
<dt id="io.marread">
<code class="descclassname">io.</code><code class="descname">marread</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.marread" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frame, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-mat2json"></span><dl class="function">
<dt id="io.mat2json">
<code class="descclassname">io.</code><code class="descname">mat2json</code><span class="sig-paren">(</span><em>M</em>, <em>F</em><span class="sig-paren">)</span><a class="headerlink" href="#io.mat2json" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">io.mat2json is a function.</div>
<div class="line">J = mat2json(M, F)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">J</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-mcs-mesh"></span><dl class="function">
<dt id="io.mcs_mesh">
<code class="descclassname">io.</code><code class="descname">mcs_mesh</code><span class="sig-paren">(</span><em>first_scan_no</em>, <em>no_of_intervals</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.mcs_mesh" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mcs_data, data_adjusted, pos_data</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-multiple-mcs-headers"></span><dl class="function">
<dt id="io.multiple_mcs_headers">
<code class="descclassname">io.</code><code class="descname">multiple_mcs_headers</code><span class="sig-paren">(</span><em>scan_no_from</em>, <em>scan_no_to</em><span class="sig-paren">)</span><a class="headerlink" href="#io.multiple_mcs_headers" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[] = multiple_mcs_headers(scan_no_from,scan_no_to)</div>
</div>
</dd></dl>

<span class="target" id="base-io-read-scan-positions-spec"></span><dl class="function">
<dt id="io.read_scan_positions_spec">
<code class="descclassname">io.</code><code class="descname">read_scan_positions_spec</code><span class="sig-paren">(</span><em>specdatafile</em>, <em>scans</em>, <em>motors</em><span class="sig-paren">)</span><a class="headerlink" href="#io.read_scan_positions_spec" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[pos] = read_scan_positions_spec(specdatafile,scans,motors)</div>
</div>
<div class="line-block">
<div class="line">positions = read_scan_positions(specdatafile,scan,motors) returns the</div>
<div class="line">positions of a SPEC file corresponding to two given motor names</div>
</div>
<div class="line-block">
<div class="line">Input parameters:</div>
<div class="line">specdatafile: string with the file name of the SPEC data file</div>
<div class="line">(e.g.’~/Data10/specES1/dat-files/specES1_started_2017_07_11_1633.dat’ )</div>
<div class="line">scans: scan number(s) (e.g. [2:77,88])</div>
<div class="line">motors: 1x2 cell array with scanning motor names (e.g. {‘samx’,’samy’})</div>
</div>
<div class="line-block">
<div class="line">The output is a structure array with length(scans) number of elements,</div>
<div class="line">each element containing in the field ‘data’ an Nx2 array with N</div>
<div class="line">being the number of points in the scan. The two columns contain motor</div>
<div class="line">positions for motors samx and samy, respectively, if motors={‘samx’,’samy’}</div>
</div>
<div class="line-block">
<div class="line">Example:</div>
<div class="line">pos=read_scan_positions_spec(‘~/Data10/specES1/dat-files/specES1_started_2017_07_11_1633.dat’,[58:59],{‘samx’,’samy’});</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">pos</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-save-append"></span><dl class="function">
<dt id="io.save_append">
<code class="descclassname">io.</code><code class="descname">save_append</code><span class="sig-paren">(</span><em>filename</em>, <em>vars</em>, <em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#io.save_append" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Append the varible to the file</div>
<div class="line">function save_append(filename,  vars, x)</div>
</div>
<div class="line-block">
<div class="line">Input:</div>
<div class="line">filename - file to which the varible will be appended</div>
<div class="line">vars - the varible to save, eg, saveme</div>
<div class="line">x - the string of the variable name, eg, ‘saveme’</div>
</div>
<div class="line-block">
<div class="line">Note:</div>
<div class="line">This is a temporary solution because either</div>
<div class="line">‘save’ nor ‘vars=evalin(‘caller’, varargin{1})’</div>
<div class="line">works for parfor..</div>
</div>
</dd></dl>

<span class="target" id="base-io-savefast-safe"></span><dl class="function">
<dt id="io.savefast_safe">
<code class="descclassname">io.</code><code class="descname">savefast_safe</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.savefast_safe" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">savefast: fast saves of large arrays to .mat files</div>
</div>
<div class="line-block">
<div class="line">Matlab’s ‘save’ command can be very slow when saving large arrays,</div>
<div class="line">because by default Matlab attempts to use compression. This function</div>
<div class="line">provides a much faster alternative, at the cost of larger files.</div>
</div>
<div class="line-block">
<div class="line">The syntax is identical to that of the Matlab save command.</div>
</div>
<div class="line-block">
<div class="line">Example:</div>
<div class="line">&gt;&gt; ops = struct(‘algorithm’, ‘greedy’);</div>
<div class="line">&gt;&gt; A = int32(randi(20, 1000, 1200, 40));</div>
<div class="line">&gt;&gt; B = randn(500, 1800, 60);</div>
<div class="line">&gt;&gt; tic; save /tmp/test ops A B; toc</div>
<div class="line">Elapsed time is 22.980294 seconds.</div>
<div class="line">&gt;&gt; tic; savefast /tmp/test ops A B; toc</div>
<div class="line">Elapsed time is 0.571098 seconds.</div>
</div>
</dd></dl>

<span class="target" id="base-io-sendsms"></span><dl class="function">
<dt id="io.sendSMS">
<code class="descclassname">io.</code><code class="descname">sendSMS</code><span class="sig-paren">(</span><em>recipient</em>, <em>msg</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.sendSMS" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">SENDSMS send message to given phone number(s)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>recipient</strong> – phone number(s);</li>
<li><strong>msg</strong> – message</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><em>optional</em></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>binary_path</strong> – path to sendmail binary file</li>
<li><strong>server</strong> – server address</li>
<li><strong>sleep</strong> – sleep time between messages</li>
<li><strong>logfile</strong> – logfile+path to keep track of past activities</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">EXAMPLES</div>
<div class="line">sendSMS(‘0041123456789’, ‘done!’);</div>
<div class="line">sendSMS({‘076123456’, ‘076987654’}, ‘done!’)</div>
<div class="line">sendSMS({‘076123456’, ‘076987654’}, {‘message1’, ‘message2’})</div>
<div class="line">sendSMS({‘076123456’, ‘076987654’}, ‘done!’, ‘sleep’, 3600)</div>
</div>
</dd></dl>

<span class="target" id="base-io-spec-help"></span><dl class="function">
<dt id="io.spec_help">
<code class="descclassname">io.</code><code class="descname">spec_help</code><span class="sig-paren">(</span><em>m_file_name</em><span class="sig-paren">)</span><a class="headerlink" href="#io.spec_help" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[] = spec_help(m_file_name)</div>
</div>
</dd></dl>

<span class="target" id="base-io-spec-read"></span><dl class="function">
<dt id="io.spec_read">
<code class="descclassname">io.</code><code class="descname">spec_read</code><span class="sig-paren">(</span><em>specDatFile</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.spec_read" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function [varargout] = spec_read(specDatFile, varargin)</div>
<div class="line">call ‘spec_read()’ for further help</div>
</div>
<div class="line-block">
<div class="line">please reports bugs, problems, suggestions for improvements to:</div>
<div class="line">CXS group</div>
</div>
<div class="line-block">
<div class="line">the case of duplicate scannumbers in the spec file, and how to</div>
<div class="line">address them remains to be implemented</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-speread"></span><dl class="function">
<dt id="io.speread">
<code class="descclassname">io.</code><code class="descname">speread</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.speread" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frame, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="io-cbf">
<h3>+io/+CBF<a class="headerlink" href="#io-cbf" title="Permalink to this headline">¶</a></h3>
<span class="target" id="base-io-cbf-cbfread"></span><dl class="function">
<dt id="io.CBF.cbfread">
<code class="descclassname">io.CBF.</code><code class="descname">cbfread</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.CBF.cbfread" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frame, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-cbf-cbfwrite"></span><dl class="function">
<dt id="io.CBF.cbfwrite">
<code class="descclassname">io.CBF.</code><code class="descname">cbfwrite</code><span class="sig-paren">(</span><em>filename</em>, <em>frame</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.CBF.cbfwrite" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">fcount_total</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="io-hdf">
<h3>+io/+HDF<a class="headerlink" href="#io-hdf" title="Permalink to this headline">¶</a></h3>
<span class="target" id="base-io-hdf-add-content"></span><dl class="function">
<dt id="io.HDF.add_content">
<code class="descclassname">io.HDF.</code><code class="descname">add_content</code><span class="sig-paren">(</span><em>data</em>, <em>gid</em>, <em>plist</em>, <em>comp</em>, <em>overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.add_content" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">ADD_CONTENT write matlab structure to H5 file</div>
</div>
</dd></dl>

<span class="target" id="base-io-hdf-add-groups"></span><dl class="function">
<dt id="io.HDF.add_groups">
<code class="descclassname">io.HDF.</code><code class="descname">add_groups</code><span class="sig-paren">(</span><em>fileID</em>, <em>gpath</em>, <em>plist</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.add_groups" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">ADD_GROUPS add groups or open them if they exist</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">gid</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-hdf-get-datatype"></span><dl class="function">
<dt id="io.HDF.get_datatype">
<code class="descclassname">io.HDF.</code><code class="descname">get_datatype</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.get_datatype" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Determine datatype for HDF files</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">datatype_h5, data</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-hdf-hdf5-append-attr"></span><dl class="function">
<dt id="io.HDF.hdf5_append_attr">
<code class="descclassname">io.HDF.</code><code class="descname">hdf5_append_attr</code><span class="sig-paren">(</span><em>file</em>, <em>attr</em>, <em>loc</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.hdf5_append_attr" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">HDF5_APPEND_ATTR Append an attribute to a dataset</div>
</div>
<div class="line-block">
<div class="line">file…       HDF filename</div>
<div class="line">attr…       structure of attributes</div>
<div class="line">loc…        location of the dataset that needs to be removed</div>
</div>
</dd></dl>

<span class="target" id="base-io-hdf-hdf5-attr-exists"></span><dl class="function">
<dt id="io.HDF.hdf5_attr_exists">
<code class="descclassname">io.HDF.</code><code class="descname">hdf5_attr_exists</code><span class="sig-paren">(</span><em>file</em>, <em>name</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.hdf5_attr_exists" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">HDF5_ATTR_EXISTS check if attribute exists in given file</div>
<div class="line">file…     h5 file path</div>
<div class="line">attr…     dataset name</div>
</div>
<div class="line-block">
<div class="line"><em>optional</em></div>
<div class="line">gpath…    path within the h5 file; default root (/)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-hdf-hdf5-cp-file"></span><dl class="function">
<dt id="io.HDF.hdf5_cp_file">
<code class="descclassname">io.HDF.</code><code class="descname">hdf5_cp_file</code><span class="sig-paren">(</span><em>orig_filename</em>, <em>duplicate_filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.hdf5_cp_file" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">HDF5_CP_FILE copy HDF files</div>
<div class="line">orig_filename…        source file</div>
<div class="line">duplicate_filename…   target file</div>
</div>
<div class="line-block">
<div class="line"><em>optional</em>              given as name/value pair</div>
<div class="line">groups…               groups to copy; either string or cell of</div>
<div class="line">strings; default: everything in root</div>
<div class="line">copy_type…            ‘deep’, ‘normal’ or ‘shallow’ copy;</div>
<div class="line">‘shallow’ creates external links in target file;</div>
<div class="line">‘normal’ is similar to linux ‘cp’ command;</div>
<div class="line">‘deep’ dereferences all internal and external links;</div>
<div class="line">default: ‘shallow’</div>
</div>
<div class="line-block">
<div class="line">EXAMPLES:</div>
<div class="line">hdf5_cp_file(‘./test.h5’, ‘./test_new.h5’)</div>
<div class="line">hdf5_cp_file(‘./test.h5’, ‘./test_new.h5’, ‘copy_type’, ‘deep’);</div>
</div>
</dd></dl>

<span class="target" id="base-io-hdf-hdf5-dset-exists"></span><dl class="function">
<dt id="io.HDF.hdf5_dset_exists">
<code class="descclassname">io.HDF.</code><code class="descname">hdf5_dset_exists</code><span class="sig-paren">(</span><em>file</em>, <em>dset</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.hdf5_dset_exists" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">HDF5_DSET_EXISTS check if dataset exists in given file</div>
<div class="line">file…         h5 file path</div>
<div class="line">dset…         dataset name</div>
</div>
<div class="line-block">
<div class="line"><em>optional</em></div>
<div class="line">gpath…        path within the h5 file; default root (/)</div>
<div class="line">check_links…  include links; default true</div>
</div>
<div class="line-block">
<div class="line">EXAMPLES:</div>
<div class="line">out = io.HDF.hdf5_dset_exists(‘./recons.h5’,</div>
<div class="line">‘object_phase_unwrapped’, ‘/reconstruction’, true);</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-hdf-hdf5-load"></span><dl class="function">
<dt id="io.HDF.hdf5_load">
<code class="descclassname">io.HDF.</code><code class="descname">hdf5_load</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.hdf5_load" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">HDF5_LOAD Load an hdf5 file</div>
</div>
<div class="line-block">
<div class="line">DATA = HDF5_LOAD(filename) reads a complete file hierarchy recursively, with</div>
<div class="line">file name/path being specified by the ‘filename’ argument</div>
</div>
<div class="line-block">
<div class="line">DATA = HDF5_LOAD(filename, ‘-a’) reads a complete file hierarchy</div>
<div class="line">recursively, including attributes</div>
</div>
<div class="line-block">
<div class="line">DATA = HDF5_LOAD(filename, location) reads a particular group, link, or a single dataset</div>
<div class="line">specified by the ‘location’ argument</div>
</div>
<div class="line-block">
<div class="line">ATT = HDF5_LOAD(filename, location, ‘-a’) reads all datasets and attributes associated</div>
<div class="line">with a particular location in the file (group, link or dataset)</div>
</div>
<div class="line-block">
<div class="line">ATT = HDF5_LOAD(filename, location, ‘-ca’) reads all datasets and attributes associated</div>
<div class="line">with a particular location in the file (group, link or dataset) and</div>
<div class="line">converts datasets to a specific matlab class based on attribute ‘MATLAB_class’</div>
</div>
<div class="line-block">
<div class="line">SLICE = HDF5_LOAD(filename, location, {rowRange, colRange, frameRange, …}) reads a</div>
<div class="line">portion of a dataset along specified dimentions, where slicing ranges can be defined in</div>
<div class="line">the following ways (negative indexes count from the end of the corresponding dimensions):</div>
<div class="line">range = scalar_index - reads a particular row/col/frame/… (indentical to</div>
<div class="line">‘range = [scalar_index, scalar_index]’)</div>
<div class="line">range = [start_index, end_index] - reads all data between start and end</div>
<div class="line">indexes</div>
<div class="line">range = [start_index, Inf] - reads all data from start_index to the last</div>
<div class="line">existing element in the file</div>
<div class="line">range = [], or range is omitted at the end - reads the full range of values for that</div>
<div class="line">dimention (indentical to ‘range = [1, Inf]’)</div>
</div>
<div class="line-block">
<div class="line">Examples:</div>
<div class="line">hdf5_load(‘scan_003.hdf5’)</div>
<div class="line">hdf5_load(‘scan_003.hdf5’, ‘/entry/sample/description’)</div>
<div class="line">hdf5_load(‘scan_003.hdf5’, ‘/entry/collection/data/spec’, ‘-a’)</div>
<div class="line">hdf5_load(‘scan_003.hdf5’, ‘/entry/instrument/Pilatus_2M/data’, {5})</div>
<div class="line">hdf5_load(‘scan_003.hdf5’, ‘/entry/instrument/Pilatus_2M/data’, {[-100, Inf]})</div>
<div class="line">hdf5_load(‘scan_003.hdf5’, ‘/entry/instrument/Pilatus_2M/data’, {5, [500, Inf], [1, 100]})</div>
<div class="line">hdf5_load(‘scan_003.hdf5’, ‘/entry/instrument/Pilatus_2M/data’, {[], [], [1, 100]})</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">data</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-hdf-hdf5-mv-data"></span><dl class="function">
<dt id="io.HDF.hdf5_mv_data">
<code class="descclassname">io.HDF.</code><code class="descname">hdf5_mv_data</code><span class="sig-paren">(</span><em>file</em>, <em>loc_origin</em>, <em>loc_dest</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.hdf5_mv_data" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">HDF5_MV_DATA Move data within an HDF5 file</div>
<div class="line">hdf5_mv_data creates a new (UNIX-like) hard link at loc_dest to the dataset at</div>
<div class="line">loc_origin and deletes the hard link to the dataset at loc_origin.</div>
</div>
<div class="line-block">
<div class="line">file…       HDF filename</div>
<div class="line">loc_origin… location of the data that needs to be moved</div>
<div class="line">loc_dest…   destination and name of the new data</div>
</div>
<div class="line-block">
<div class="line">EXAMPLE:</div>
<div class="line">% move dataset probe from root to group measurements</div>
<div class="line">hdf5_mv_data(‘./awesome_file.h5’, ‘probe’, ‘measurements/probe’)</div>
</div>
<div class="line-block">
<div class="line">Please notice that all groups and datasets have to exist before running</div>
<div class="line">the script!</div>
</div>
</dd></dl>

<span class="target" id="base-io-hdf-hdf5-rm-attr"></span><dl class="function">
<dt id="io.HDF.hdf5_rm_attr">
<code class="descclassname">io.HDF.</code><code class="descname">hdf5_rm_attr</code><span class="sig-paren">(</span><em>file</em>, <em>loc</em>, <em>attr_name</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.hdf5_rm_attr" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">HDF5_RM_ATTR Delete attribute(s) from HDF file</div>
</div>
<div class="line-block">
<div class="line">file…         HDF filename</div>
<div class="line">loc…          location within the HDF file</div>
<div class="line">attr_name…    string or cell of strings containing the names of the</div>
<div class="line">obsolete attributes</div>
</div>
</dd></dl>

<span class="target" id="base-io-hdf-hdf5-rm-data"></span><dl class="function">
<dt id="io.HDF.hdf5_rm_data">
<code class="descclassname">io.HDF.</code><code class="descname">hdf5_rm_data</code><span class="sig-paren">(</span><em>file</em>, <em>loc</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.hdf5_rm_data" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">HDF5_RM_DATA Delete a dataset within an HDF5 file</div>
</div>
<div class="line-block">
<div class="line">file…       HDF filename</div>
<div class="line">loc…        location of the dataset that needs to be removed</div>
</div>
<div class="line-block">
<div class="line">Please notice that HDF5 does not free the space after removing datasets!</div>
</div>
</dd></dl>

<span class="target" id="base-io-hdf-hdf5read-main"></span><dl class="function">
<dt id="io.HDF.hdf5read_main">
<code class="descclassname">io.HDF.</code><code class="descname">hdf5read_main</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.hdf5read_main" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frame, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-io-hdf-save2hdf5"></span><dl class="function">
<dt id="io.HDF.save2hdf5">
<code class="descclassname">io.HDF.</code><code class="descname">save2hdf5</code><span class="sig-paren">(</span><em>filename</em>, <em>data</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.save2hdf5" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">SAVE2HDF5 saves matlab data to a Hierarchical Data Format file (hdf5)</div>
</div>
<div class="line-block">
<div class="line">filename…     full path to file, including file extension</div>
<div class="line">data…         matlab structure or array or link</div>
<div class="line">data_name…    needed if input data is not a matlab structure, needs</div>
<div class="line">to be given as name/value pair</div>
</div>
<div class="line-block">
<div class="line"><em>optional</em></div>
<div class="line">overwrite…    replace existing file if it exists</div>
<div class="line">gpath…        specify the group to which you want to append the data</div>
<div class="line">(only if data is an array); default root (‘/’)</div>
<div class="line">Attributes…   structure of attributes; will be appended to current</div>
<div class="line">gpath</div>
<div class="line">comp…         compression level; default 0 (no compression)</div>
<div class="line">creator…      attribute in root; default ‘ptycho_recons’</div>
</div>
<div class="line-block">
<div class="line">If you want to save a structure, everything declared within an ‘Attributes’</div>
<div class="line">fieldname will be treated as an attribute to the current group.</div>
<div class="line">If you want to add attributes to a dataset, you have to define your</div>
<div class="line">data within .Value and your attributes within .Attributes.</div>
</div>
<div class="line-block">
<div class="line">A simple structure could look like:</div>
<div class="line">h5_struc = [];</div>
<div class="line">h5_struc.probe_mask = ones(256,256);</div>
<div class="line">h5_struc.Attributes.probe_id = 1;</div>
<div class="line">h5_struc.measurement.n0.diff = fmag(:,:,1);</div>
<div class="line">h5_struc.measurement.n0.Attributes.detector = 0;</div>
<div class="line">h5_struc.measurement.n1.diff.Value = fmag(:,:,2);</div>
<div class="line">h5_struc.measurement.n1.diff.Attributes.slice = 2;</div>
</div>
<div class="line-block">
<div class="line">fmag(:,:,1) will be written to dataset ‘diff’ in group ‘/measurement/n0’</div>
<div class="line">fmag(:,:,2) with attribute ‘slice’ will be written to dataset ‘diff’ in</div>
<div class="line">group ‘/measurement/n1’</div>
</div>
<div class="line-block">
<div class="line">EXAMPLES:</div>
<div class="line">-) if data is a matlab structure:</div>
<div class="line">save2hdf5(‘./awesome_file.h5’, data);</div>
<div class="line">save2hdf5(‘./awesome_file.h5’, data, ‘overwrite’, true);</div>
</div>
<div class="line-block">
<div class="line">-) if data is a matlab array:</div>
<div class="line">save2hdf5(‘./awesome_file.h5’, data, ‘data_name’, data_name);</div>
<div class="line">save2hdf5(‘./awesome_file.h5’, data, ‘data_name’, ‘my_dataset’,…</div>
<div class="line">‘gpath’, ‘group1/group2’, ‘Attributes’, attr_struc);</div>
</div>
<div class="line-block">
<div class="line">-) if data is a link:</div>
<div class="line">currently, only external links (‘ext’) and internal soft links</div>
<div class="line">(‘int_soft’) are supported</div>
</div>
<div class="line-block">
<div class="line">external links have to be specified by a single string with</div>
<div class="line">3 sections: ‘&lt;link_type&gt;:&lt;file_path&gt;:&lt;target_object&gt;’</div>
</div>
<div class="line-block">
<div class="line">e.g.: ‘ext:./awesome_file2.h5:/data’</div>
<div class="line">save2hdf5(‘./awesome_file.h5’,…</div>
<div class="line">‘ext:./awesome_file2.h5:/data’, ‘data_name’, data_name)</div>
</div>
<div class="line-block">
<div class="line">will create a link called $data_name to dataset (or group) ‘/data’</div>
<div class="line">in ‘./awesome_file2.h5’</div>
</div>
<div class="line-block">
<div class="line">internal links have to be specified by a single string with</div>
<div class="line">2 sections: ‘&lt;link_type&gt;:&lt;target_object&gt;’</div>
</div>
<div class="line-block">
<div class="line">e.g.: ‘int_soft:/data’</div>
<div class="line">save2hdf5(‘./awesome_file.h5’,…</div>
<div class="line">‘int_soft:/data’, ‘data_name’, data_name, ‘gpath’, ‘g1/g2’)</div>
</div>
<div class="line-block">
<div class="line">will create a link called $data_name to dataset (or group) ‘/data’</div>
<div class="line">in ‘/g1/g2’</div>
</div>
<div class="line-block">
<div class="line">Please notice that structures are not supported as attributes, i.e.</div>
<div class="line">h5_struc = [];</div>
<div class="line">h5_struc.attr.probe.probe_id = 1;</div>
</div>
<div class="line-block">
<div class="line">save2hdf5(‘./awesome_file.h5’, h5_struc)</div>
</div>
<div class="line-block">
<div class="line">will crash!</div>
</div>
</dd></dl>

<span class="target" id="base-io-hdf-write-attribute"></span><dl class="function">
<dt id="io.HDF.write_attribute">
<code class="descclassname">io.HDF.</code><code class="descname">write_attribute</code><span class="sig-paren">(</span><em>gid</em>, <em>data</em>, <em>data_name</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.write_attribute" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">WRITE_ATTRIBUTE write attribute data_name with value data to ID gid</div>
</div>
</dd></dl>

<span class="target" id="base-io-hdf-write-dataset"></span><dl class="function">
<dt id="io.HDF.write_dataset">
<code class="descclassname">io.HDF.</code><code class="descname">write_dataset</code><span class="sig-paren">(</span><em>data</em>, <em>gid</em>, <em>data_name</em>, <em>plist</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.write_dataset" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">WRITE_DATASET write dataset data_name, containing data to ID gid</div>
</div>
</dd></dl>

</div>
<div class="section" id="io-hdf-private">
<h3>+io/+HDF/private<a class="headerlink" href="#io-hdf-private" title="Permalink to this headline">¶</a></h3>
<span class="target" id="base-io-hdf-rm-delimiter"></span><dl class="function">
<dt id="io.HDF.rm_delimiter">
<code class="descclassname">io.HDF.</code><code class="descname">rm_delimiter</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#io.HDF.rm_delimiter" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">RM_DELIMITER makes sure that the path does not start with /</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">path</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="io-private">
<h3>+io/private<a class="headerlink" href="#io-private" title="Permalink to this headline">¶</a></h3>
<span class="target" id="base-io-image-orient-help"></span><dl class="function">
<dt id="io.image_orient_help">
<code class="descclassname">io.</code><code class="descname">image_orient_help</code><span class="sig-paren">(</span><em>m_file_name</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.image_orient_help" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[] = image_orient_help(m_file_name,varargin)</div>
<div class="line">parameter help for image_orient and calling functions</div>
</div>
</dd></dl>

<span class="target" id="base-io-image-read-sub-help"></span><dl class="function">
<dt id="io.image_read_sub_help">
<code class="descclassname">io.</code><code class="descname">image_read_sub_help</code><span class="sig-paren">(</span><em>m_file_name</em>, <em>extension</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#io.image_read_sub_help" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[] = image_read_sub_help(m_file_name,extension,varargin)</div>
<div class="line">parameter help for sub-routines of image_read like cbfread, edfread,</div>
<div class="line">speread and fliread</div>
</div>
</dd></dl>

</div>
<div class="section" id="io-private-ptycho-reader">
<h3>+io/private/ptycho_reader<a class="headerlink" href="#io-private-ptycho-reader" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="math">
<h2>+math<a class="headerlink" href="#math" title="Permalink to this headline">¶</a></h2>
<span class="target" id="base-math-argmax"></span><dl class="function">
<dt id="math.argmax">
<code class="descclassname">math.</code><code class="descname">argmax</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#math.argmax" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION  varargout = argmax(x)</div>
</div>
<div class="line-block">
<div class="line">INputs:</div>
<div class="line">X - Ndim array</div>
<div class="line">Outputs:</div>
<div class="line">coordinates of the first value equal to maximum</div>
<div class="line">Example: [i,j] = argmax(randn(10))</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-argmin"></span><dl class="function">
<dt id="math.argmin">
<code class="descclassname">math.</code><code class="descname">argmin</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#math.argmin" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION  varargout = argmin(x)</div>
</div>
<div class="line-block">
<div class="line">INputs:</div>
<div class="line">X - Ndim array</div>
<div class="line">Outputs:</div>
<div class="line">coordinates of the first value equal to maximum</div>
<div class="line">Example: [i,j] = argmin(randn(10))</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-center"></span><dl class="function">
<dt id="math.center">
<code class="descclassname">math.</code><code class="descname">center</code><span class="sig-paren">(</span><em>X</em>, <em>use_shift</em><span class="sig-paren">)</span><a class="headerlink" href="#math.center" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">———————————————————————–</div>
<div class="line">This file is part of the PTYCHOMAT Toolbox</div>
<div class="line">Author: Michal Odstrcil, 2016</div>
<div class="line">License: Open Source under GPLv3</div>
<div class="line">Contact: <a class="reference external" href="mailto:ptychomat&#37;&#52;&#48;gmail&#46;com">ptychomat<span>&#64;</span>gmail<span>&#46;</span>com</a></div>
<div class="line">Website: <a class="reference external" href="https://bitbucket.org/michalodstrcil/ptychomat">https://bitbucket.org/michalodstrcil/ptychomat</a></div>
<div class="line">———————————————————————–</div>
<div class="line">Description:  find center of mass of matrix X,  calculate variance if</div>
<div class="line">needed</div>
<div class="line">inputs:</div>
<div class="line">X  2D stacked images</div>
<div class="line">use_shift, if true, CoM will be calculated relatively to the center</div>
<div class="line">of the image, default == true</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">pos_x, pos_y, mass, mu, sigma</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-double2int"></span><dl class="function">
<dt id="math.double2int">
<code class="descclassname">math.</code><code class="descname">double2int</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#math.double2int" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">DOUBLE2INT Convert structure values from double to int if precision can be</div>
<div class="line">preserved.</div>
</div>
<div class="line-block">
<div class="line">EXAMPLE:</div>
<div class="line">p.value1 = 10.25;</div>
<div class="line">p.value2 = 2;</div>
</div>
<div class="line-block">
<div class="line">p_int = double2int(p);</div>
</div>
<div class="line-block">
<div class="line">p_int.value1</div>
<div class="line">ans =</div>
<div class="line">10.2500</div>
</div>
<div class="line-block">
<div class="line">p_int.value2</div>
<div class="line">ans =</div>
<div class="line">uint32</div>
<div class="line">2</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">p</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-fft2-partial"></span><dl class="function">
<dt id="math.fft2_partial">
<code class="descclassname">math.</code><code class="descname">fft2_partial</code><span class="sig-paren">(</span><em>x</em>, <em>split</em>, <em>inverse</em><span class="sig-paren">)</span><a class="headerlink" href="#math.fft2_partial" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION x = fft2_partial(x,split)</div>
<div class="line">apply fft only on smaller blocks (important for GPU)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-fft-partial"></span><dl class="function">
<dt id="math.fft_partial">
<code class="descclassname">math.</code><code class="descname">fft_partial</code><span class="sig-paren">(</span><em>x</em>, <em>fft_axis</em>, <em>split_axis</em>, <em>split</em>, <em>inverse</em><span class="sig-paren">)</span><a class="headerlink" href="#math.fft_partial" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION x = fft_partial(x,fft_axis,split_axis, split, inverse = false)</div>
<div class="line">apply fft only on smaller blocks (important for GPU)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-fftn-partial"></span><dl class="function">
<dt id="math.fftn_partial">
<code class="descclassname">math.</code><code class="descname">fftn_partial</code><span class="sig-paren">(</span><em>x</em>, <em>split</em><span class="sig-paren">)</span><a class="headerlink" href="#math.fftn_partial" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION x = fftn_partial(x,split)</div>
<div class="line">apply fft only on smaller blocks (important for GPU)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-fftshift-2d"></span><dl class="function">
<dt id="math.fftshift_2D">
<code class="descclassname">math.</code><code class="descname">fftshift_2D</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#math.fftshift_2D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">———————————————————————–</div>
<div class="line">This file is part of the PTYCHOMAT Toolbox</div>
<div class="line">Author: Michal Odstrcil, 2016</div>
<div class="line">License: Open Source under GPLv3</div>
<div class="line">Contact: <a class="reference external" href="mailto:ptychomat&#37;&#52;&#48;gmail&#46;com">ptychomat<span>&#64;</span>gmail<span>&#46;</span>com</a></div>
<div class="line">Website: <a class="reference external" href="https://bitbucket.org/michalodstrcil/ptychomat">https://bitbucket.org/michalodstrcil/ptychomat</a></div>
<div class="line">———————————————————————–</div>
<div class="line">Description:   faster version of matlab fftshift to work for stack of</div>
<div class="line">2D images</div>
<div class="line">Inputs:  2D or stack of 2D images</div>
<div class="line">Outputs:</div>
<div class="line">x - 2D or stack of 2D images after fftshift along first 2 dimensions</div>
<div class="line">idx - precalculated indices for fftshift operation</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x, idx</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-fsvd"></span><dl class="function">
<dt id="math.fsvd">
<code class="descclassname">math.</code><code class="descname">fsvd</code><span class="sig-paren">(</span><em>A</em>, <em>k</em>, <em>i</em>, <em>usePowerMethod</em><span class="sig-paren">)</span><a class="headerlink" href="#math.fsvd" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FSVD Fast Singular Value Decomposition</div>
</div>
<div class="line-block">
<div class="line">[U,S,V] = FSVD(A,k,i,usePowerMethod) computes the truncated singular</div>
<div class="line">value decomposition of the input matrix A upto rank k using i levels of</div>
<div class="line">Krylov method as given in [1], p. 3.</div>
</div>
<div class="line-block">
<div class="line">If usePowerMethod is given as true, then only exponent i is used (i.e.</div>
<div class="line">as power method). See [2] p.9, Randomized PCA algorithm for details.</div>
</div>
<div class="line-block">
<div class="line">[1] Halko, N., Martinsson, P. G., Shkolnisky, Y., &amp; Tygert, M. (2010).</div>
<div class="line">An algorithm for the principal component analysis of large data sets.</div>
<div class="line">Arxiv preprint arXiv:1007.5510, 0526. Retrieved April 1, 2011, from</div>
<div class="line"><a class="reference external" href="http://arxiv.org/abs/1007.5510">http://arxiv.org/abs/1007.5510</a>.</div>
</div>
<div class="line-block">
<div class="line">[2] Halko, N., Martinsson, P. G., &amp; Tropp, J. A. (2009). Finding</div>
<div class="line">structure with randomness: Probabilistic algorithms for constructing</div>
<div class="line">approximate matrix decompositions. Arxiv preprint arXiv:0909.4061.</div>
<div class="line">Retrieved April 1, 2011, from <a class="reference external" href="http://arxiv.org/abs/0909.4061">http://arxiv.org/abs/0909.4061</a>.</div>
</div>
<div class="line-block">
<div class="line">See also SVD.</div>
</div>
<div class="line-block">
<div class="line">Copyright 2011 Ismail Ari, <a class="reference external" href="http://ismailari.com">http://ismailari.com</a>.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">U, S, V</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-get-img-grad"></span><dl class="function">
<dt id="math.get_img_grad">
<code class="descclassname">math.</code><code class="descname">get_img_grad</code><span class="sig-paren">(</span><em>img</em>, <em>axis</em>, <em>split</em><span class="sig-paren">)</span><a class="headerlink" href="#math.get_img_grad" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION [dX, dY] = get_img_grad(img, axis, split)</div>
<div class="line">get vertical and horizontal gradient of the image using FFT</div>
<div class="line">Inputs:</div>
<div class="line">img   - stack of images</div>
<div class="line">split - split for GPU fft_partial</div>
<div class="line">axis  - direction of the derivative</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dX, dY</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-get-img-int-1d"></span><dl class="function">
<dt id="math.get_img_int_1D">
<code class="descclassname">math.</code><code class="descname">get_img_int_1D</code><span class="sig-paren">(</span><em>img</em>, <em>ax</em><span class="sig-paren">)</span><a class="headerlink" href="#math.get_img_int_1D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION integer = get_img_int(img, ax)</div>
<div class="line">use FFT to integate the image along one axis -&gt; can be used for phase</div>
<div class="line">unwrapping</div>
<div class="line">Inputs:</div>
<div class="line">img - stack of images</div>
<div class="line">ax  - integration axis</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">integer</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-get-img-int-2d"></span><dl class="function">
<dt id="math.get_img_int_2D">
<code class="descclassname">math.</code><code class="descname">get_img_int_2D</code><span class="sig-paren">(</span><em>dX</em>, <em>dY</em><span class="sig-paren">)</span><a class="headerlink" href="#math.get_img_int_2D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION integral = get_img_int_2D(dX,dY)</div>
<div class="line">use FFT2 to integate the image along both axis -&gt; can be used for phase</div>
<div class="line">unwrapping</div>
<div class="line">Inputs:</div>
<div class="line">dX   - horizontal phase gradient</div>
<div class="line">dY   - vertical phase gradient</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">integral</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-get-phase-gradient-1d"></span><dl class="function">
<dt id="math.get_phase_gradient_1D">
<code class="descclassname">math.</code><code class="descname">get_phase_gradient_1D</code><span class="sig-paren">(</span><em>img</em>, <em>ax</em>, <em>step</em>, <em>shift</em><span class="sig-paren">)</span><a class="headerlink" href="#math.get_phase_gradient_1D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">d_img = get_phase_gradient_1D(img, ax, step)</div>
<div class="line">FUNCTION get gradient of phase of image IMG along axis AX. Accept either</div>
<div class="line">complex image or unwrapped phase</div>
<div class="line">Inputs</div>
<div class="line">img - stack of complex valued input images</div>
<div class="line">ax - axis of derivative, default = 2</div>
<div class="line">step - step used to caluclate the central difference</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">d_img</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-get-phase-gradient-2d"></span><dl class="function">
<dt id="math.get_phase_gradient_2D">
<code class="descclassname">math.</code><code class="descname">get_phase_gradient_2D</code><span class="sig-paren">(</span><em>img</em>, <em>step</em>, <em>padding</em><span class="sig-paren">)</span><a class="headerlink" href="#math.get_phase_gradient_2D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[d_X, d_Y] = get_phase_gradient_2D(img, step)</div>
<div class="line">FUNCTION get 2D gradient of phase of image IMG. Accept either</div>
<div class="line">complex image or unwrapped phase</div>
<div class="line">Inputs</div>
<div class="line">img - stack of complex valued input images</div>
<div class="line">step - step used to caluclate the central difference</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">d_X, d_Y</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-ifft2-partial"></span><dl class="function">
<dt id="math.ifft2_partial">
<code class="descclassname">math.</code><code class="descname">ifft2_partial</code><span class="sig-paren">(</span><em>x</em>, <em>split</em><span class="sig-paren">)</span><a class="headerlink" href="#math.ifft2_partial" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION x = ifft2_partial(x,split)</div>
<div class="line">apply fft only on smaller blocks (important for GPU)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-ifft-partial"></span><dl class="function">
<dt id="math.ifft_partial">
<code class="descclassname">math.</code><code class="descname">ifft_partial</code><span class="sig-paren">(</span><em>x</em>, <em>fft_axis</em>, <em>split_axis</em>, <em>split</em><span class="sig-paren">)</span><a class="headerlink" href="#math.ifft_partial" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION x = ifft_partial(x,fft_axis,split_axis, split)</div>
<div class="line">apply ifft only on smaller blocks (important for GPU)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-ifftn-partial"></span><dl class="function">
<dt id="math.ifftn_partial">
<code class="descclassname">math.</code><code class="descname">ifftn_partial</code><span class="sig-paren">(</span><em>x</em>, <em>split</em><span class="sig-paren">)</span><a class="headerlink" href="#math.ifftn_partial" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION x = ifftn_partial(x,split)</div>
<div class="line">apply fftn only on smaller blocks (important for GPU)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-ifftshift-2d"></span><dl class="function">
<dt id="math.ifftshift_2D">
<code class="descclassname">math.</code><code class="descname">ifftshift_2D</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#math.ifftshift_2D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">———————————————————————–</div>
<div class="line">This file is part of the PTYCHOMAT Toolbox</div>
<div class="line">Author: Michal Odstrcil, 2016</div>
<div class="line">License: Open Source under GPLv3</div>
<div class="line">Contact: <a class="reference external" href="mailto:ptychomat&#37;&#52;&#48;gmail&#46;com">ptychomat<span>&#64;</span>gmail<span>&#46;</span>com</a></div>
<div class="line">Website: <a class="reference external" href="https://bitbucket.org/michalodstrcil/ptychomat">https://bitbucket.org/michalodstrcil/ptychomat</a></div>
<div class="line">———————————————————————–</div>
<div class="line">Description:   faster version of matlab fftshift to work for stack of</div>
<div class="line">2D images</div>
<div class="line">Inputs:  2D or stack of 2D images</div>
<div class="line">Outputs:</div>
<div class="line">x - 2D or stack of 2D images after fftshift along first 2 dimensions</div>
<div class="line">idx - precalculated indices for fftshift operation</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x, idx</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-isint"></span><dl class="function">
<dt id="math.isint">
<code class="descclassname">math.</code><code class="descname">isint</code><span class="sig-paren">(</span><em>x</em>, <em>prec</em><span class="sig-paren">)</span><a class="headerlink" href="#math.isint" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">true if all values or X is integers, but class can be arbitrary</div>
<div class="line">numerical array</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">val</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-legendrepoly1d-2"></span><dl class="function">
<dt id="math.legendrepoly1D_2">
<code class="descclassname">math.</code><code class="descname">legendrepoly1D_2</code><span class="sig-paren">(</span><em>X</em>, <em>maxorder</em>, <em>w</em><span class="sig-paren">)</span><a class="headerlink" href="#math.legendrepoly1D_2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Generates a 1D orthonormal polynomial base</div>
<div class="line">polys = legendrepoly1D_2(X,maxorder,w);</div>
<div class="line">The weighting function has not been tested extensively</div>
<div class="line">Manuel Guizar - March 10, 2009</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">polys</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-max2"></span><dl class="function">
<dt id="math.max2">
<code class="descclassname">math.</code><code class="descname">max2</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#math.max2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">max along first two dimensions</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-mean2"></span><dl class="function">
<dt id="math.mean2">
<code class="descclassname">math.</code><code class="descname">mean2</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#math.mean2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">mean along first two dimensions</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">y</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-min2"></span><dl class="function">
<dt id="math.min2">
<code class="descclassname">math.</code><code class="descname">min2</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#math.min2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">min along first two dimensions</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-nnorm"></span><dl class="function">
<dt id="math.nnorm">
<code class="descclassname">math.</code><code class="descname">nnorm</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span><a class="headerlink" href="#math.nnorm" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION N = NNORM(a)</div>
<div class="line">N-Dimensional norm.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">n</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-norm2"></span><dl class="function">
<dt id="math.norm2">
<code class="descclassname">math.</code><code class="descname">norm2</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#math.norm2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">1/N * Euclidean norm aling first 2 dims</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-peakfit2d"></span><dl class="function">
<dt id="math.peakfit2d">
<code class="descclassname">math.</code><code class="descname">peakfit2d</code><span class="sig-paren">(</span><em>Z</em><span class="sig-paren">)</span><a class="headerlink" href="#math.peakfit2d" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Find sub-sample location of a global peak within 2D-matrix by applying</div>
<div class="line">two dimensional polynomial fit &amp; extremum detection.</div>
</div>
<div class="line-block">
<div class="line">Sample usage:</div>
<div class="line">&gt;&gt; M = exp(-((1:30) - 19.5).^2/(2*5^2)); % gauss: center=19.5; sigma=5</div>
<div class="line">&gt;&gt; P = peakfit2d(M’<a href="#id5"><span class="problematic" id="id6">*</span></a>M);                  % find peak in 2D-gauss</div>
<div class="line">&gt;&gt; disp(P);</div>
<div class="line">19.5050   19.5050</div>
</div>
<div class="line-block">
<div class="line">Algebraic solution derived with the following steps:</div>
</div>
<div class="line-block">
<div class="line">0.) Define Approximation-Function:</div>
</div>
<div class="line-block">
<div class="line">F(x,y) =&gt; z = a*x^2+b*x*y+c*x+d+e*y^2+f*y</div>
</div>
<div class="line-block">
<div class="line">1.) Formulate equation for sum of squared differences with</div>
</div>
<div class="line-block">
<div class="line">x=-1:1,y=-1:1,z=Z(x,y)</div>
</div>
<div class="line-block">
<div class="line">SSD = [ a*(-1)^2+b*(-1)*(-1)+c*(-1)+d+e*(-1)^2+f*(-1) - Z(-1,-1) ]^2 + …</div>
<div class="line">…</div>
<div class="line">a*(+1)^2+b*(+1)*(+1)+c*(+1)+d+e*(+1)^2+f*(+1) - Z(-1,-1) ]^2</div>
</div>
<div class="line-block">
<div class="line">2.) Differentiate SSD towards each parameter</div>
</div>
<div class="line-block">
<div class="line">dSSD / da = …</div>
<div class="line">…</div>
<div class="line">dSSD / df = …</div>
</div>
<div class="line-block">
<div class="line">3.) Solve linear system to get [a..f]</div>
</div>
<div class="line-block">
<div class="line">4.) Differentiate F towards x and y and solve linear system for x &amp; y</div>
</div>
<div class="line-block">
<div class="line">dF(x,y) / dx = a*… = 0 !</div>
<div class="line">dF(x,y) / dy = b*… = 0 !</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">P</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-projectleg1d-2"></span><dl class="function">
<dt id="math.projectleg1D_2">
<code class="descclassname">math.</code><code class="descname">projectleg1D_2</code><span class="sig-paren">(</span><em>input</em>, <em>maxorder</em>, <em>Xext</em>, <em>w</em><span class="sig-paren">)</span><a class="headerlink" href="#math.projectleg1D_2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Proyects a 1D function onto orthonormalized base, returns residual too</div>
<div class="line">The weighting function has not been tested extensively</div>
<div class="line">[coeffs reconstrproj] = projectleg1D_2(input,maxorder,Xext,w);</div>
<div class="line">March 10, 2009</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">coeffs, reconstrproj</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-sp-quantile"></span><dl class="function">
<dt id="math.sp_quantile">
<code class="descclassname">math.</code><code class="descname">sp_quantile</code><span class="sig-paren">(</span><em>x</em>, <em>q</em>, <em>reduce</em><span class="sig-paren">)</span><a class="headerlink" href="#math.sp_quantile" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION: sp_quantile(array,quantile,reduce)</div>
<div class="line">sparse quantile (just make a fast guess)</div>
<div class="line">Inputs:</div>
<div class="line">array - inputs ndim array</div>
<div class="line">quantile - number or vector from 0 to 1 denoting quantiles</div>
<div class="line">reduce - use every n-th element for calculation</div>
<div class="line">Outputs:</div>
<div class="line">Q  - scalar or vector of quantiles of the reduced array</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Q</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-sum2"></span><dl class="function">
<dt id="math.sum2">
<code class="descclassname">math.</code><code class="descname">sum2</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#math.sum2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">sum along first two dimensions</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-unwrap2d-fft"></span><dl class="function">
<dt id="math.unwrap2D_fft">
<code class="descclassname">math.</code><code class="descname">unwrap2D_fft</code><span class="sig-paren">(</span><em>phase_diff</em>, <em>axis</em>, <em>empty_region</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#math.unwrap2D_fft" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">phase = unwrap2D_fft(img, axis, empty_region, step)</div>
<div class="line">FUNCTION  simple and very fast phase unwrapping</div>
<div class="line">Inputs:</div>
<div class="line">img     either complex valued image or real valued phase gradient</div>
<div class="line">axis    axis along which the gradient is taken</div>
<div class="line">empty_region  - 2x1 or 1x1 vector, size of empty region assumed</div>
<div class="line">around edges for phase offset removal</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">phase, phase_diff, residues</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-math-unwrap2d-fft2"></span><dl class="function">
<dt id="math.unwrap2D_fft2">
<code class="descclassname">math.</code><code class="descname">unwrap2D_fft2</code><span class="sig-paren">(</span><em>img</em>, <em>empty_region</em>, <em>step</em>, <em>weights</em>, <em>polyfit_order</em><span class="sig-paren">)</span><a class="headerlink" href="#math.unwrap2D_fft2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[phase, residues] = unwrap2D_fft2(img, empty_region, step, weights, polyfit_order)</div>
<div class="line">FUNCTION  simple and very fast 2D phase unwrapping</div>
<div class="line">Inputs:</div>
<div class="line">img     either complex valued image or real valued phase gradient</div>
<div class="line">empty_region  - 2x1 or 1x1 vector, size of empty region assumed</div>
<div class="line">around edges for phase offset removal</div>
<div class="line">step used to calculate finite difference gradient, 0 = analytical (default)</div>
<div class="line">expression</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">phase, residues</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="plotting">
<h2>+plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<dl class="object">
<dt>
<code class="descname">XANES_plot_transmission</code></dt>
<dd><div class="line-block">
<div class="line">plotting.XANES_plot_transmission is a script.</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">XANES_ptycho</code></dt>
<dd><div class="line-block">
<div class="line">Loading data</div>
</div>
</dd></dl>

<span class="target" id="base-plotting-banana-plot"></span><dl class="function">
<dt id="plotting.banana_plot">
<code class="descclassname">plotting.</code><code class="descname">banana_plot</code><span class="sig-paren">(</span><em>basepath</em>, <em>scan</em>, <em>Nx</em>, <em>Ny</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.banana_plot" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function [varargout] = banana_scan(basepath, scan, Nx, Ny)</div>
</div>
<div class="line-block">
<div class="line">This function only works for mesh scans done to see the undulator banana</div>
<div class="line">with spec. This is an example pf such scans:</div>
<div class="line">dmesh idgap -0.05 0.05 50 sl1cv -0.4 0.4 8 0.2</div>
<div class="line">50 steps (51 points) along the fast axis</div>
<div class="line">8 steps (9 points) along the slow axis</div>
</div>
<div class="line-block">
<div class="line">Input parameters:</div>
</div>
<div class="line-block">
<div class="line">basepath: main path where you are working</div>
<div class="line">scan: scan number of spec mesh scan</div>
<div class="line">Nx: number of points in fast axis</div>
<div class="line">Ny: number of steps in slow axis</div>
</div>
<div class="line-block">
<div class="line">please reports bugs, problems, suggestions for improvements to:</div>
<div class="line">CXS group</div>
</div>
<div class="line-block">
<div class="line">the case of duplicate scannumbers in the spec file, and how to</div>
<div class="line">address them remains to be implemented</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-c2image"></span><dl class="function">
<dt id="plotting.c2image">
<code class="descclassname">plotting.</code><code class="descname">c2image</code><span class="sig-paren">(</span><em>a</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.c2image" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION IM = C2IMAGE(A)</div>
</div>
<div class="line-block">
<div class="line">the phase is mapped to hue, and the amplitude</div>
<div class="line">is mapped to brightness.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">im</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-display-integ-masks"></span><dl class="function">
<dt id="plotting.display_integ_masks">
<code class="descclassname">plotting.</code><code class="descname">display_integ_masks</code><span class="sig-paren">(</span><em>filename_frame</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.display_integ_masks" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">valid_mask</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-display-valid-mask"></span><dl class="function">
<dt id="plotting.display_valid_mask">
<code class="descclassname">plotting.</code><code class="descname">display_valid_mask</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.display_valid_mask" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">valid_mask</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-franzmap"></span><dl class="function">
<dt id="plotting.franzmap">
<code class="descclassname">plotting.</code><code class="descname">franzmap</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.franzmap" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Function FM = FRANZMAP(M)</div>
<div class="line">Franz’s modified jet color map</div>
<div class="line">This function returns the colormap and should</div>
<div class="line">be used like any other colormaps, e.g.</div>
<div class="line">colormap(franzmap(128));</div>
<div class="line">or</div>
<div class="line">imwrite(uint8(255*myarray/max(max(myarray))),franzmap(256),’myarray.jpg’);</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">fm</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-ginput-ax-mod2"></span><dl class="function">
<dt id="plotting.ginput_ax_mod2">
<code class="descclassname">plotting.</code><code class="descname">ginput_ax_mod2</code><span class="sig-paren">(</span><em>ha</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.ginput_ax_mod2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">plotting.ginput_ax_mod2 is a function.</div>
<div class="line">varargout = ginput_ax_mod2(ha, n)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-hline"></span><dl class="function">
<dt id="plotting.hline">
<code class="descclassname">plotting.</code><code class="descname">hline</code><span class="sig-paren">(</span><em>y</em>, <em>in1</em>, <em>in2</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.hline" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function h=hline(y, linetype, label)</div>
</div>
<div class="line-block">
<div class="line">Draws a horizontal line on the current axes at the location specified by ‘y’.  Optional arguments are</div>
<div class="line">‘linetype’ (default is ‘r:’) and ‘label’, which applies a text label to the graph near the line.  The</div>
<div class="line">label appears in the same color as the line.</div>
</div>
<div class="line-block">
<div class="line">The line is held on the current axes, and after plotting the line, the function returns the axes to</div>
<div class="line">its prior hold state.</div>
</div>
<div class="line-block">
<div class="line">The HandleVisibility property of the line object is set to “off”, so not only does it not appear on</div>
<div class="line">legends, but it is not findable by using findobj.  Specifying an output argument causes the function to</div>
</div>
<div class="line-block">
<div class="line">overridden by setting the root’s ShowHiddenHandles property to on.</div>
</div>
<div class="line-block">
<div class="line">h = hline(42,’g’,’The Answer’)</div>
</div>
<div class="line-block">
<div class="line">the current axes, close to the line, which reads “The Answer”.</div>
</div>
<div class="line-block">
<div class="line">hline also supports vector inputs to draw multiple lines at once.  For example,</div>
</div>
<div class="line-block">
<div class="line">hline([4 8 12],{‘g’,’r’,’b’},{‘l1’,’lab2’,’LABELC’})</div>
</div>
<div class="line-block">
<div class="line">draws three lines with the appropriate labels and colors.</div>
</div>
<div class="line-block">
<div class="line">By Brandon Kuczenski for Kensington Labs.</div>
<div class="line"><a class="reference external" href="mailto:brandon_kuczenski&#37;&#52;&#48;kensingtonlabs&#46;com">brandon_kuczenski<span>&#64;</span>kensingtonlabs<span>&#46;</span>com</a></div>
<div class="line">8 November 2001</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">hhh</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-image-show"></span><dl class="function">
<dt id="plotting.image_show">
<code class="descclassname">plotting.</code><code class="descname">image_show</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.image_show" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">frame, image_handle</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-image-spec"></span><dl class="function">
<dt id="plotting.image_spec">
<code class="descclassname">plotting.</code><code class="descname">image_spec</code><span class="sig-paren">(</span><em>det_no</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.image_spec" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
</dd></dl>

<span class="target" id="base-plotting-imagesc3d"></span><dl class="function">
<dt id="plotting.imagesc3D">
<code class="descclassname">plotting.</code><code class="descname">imagesc3D</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.imagesc3D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">IMAGESC3D 3D wrapper for imagesc</div>
<div class="line">imagesc3D supports the same parameters as Matlab’s imagesc. In addition, the following</div>
<div class="line">parameters can be set</div>
</div>
<div class="line-block">
<div class="line">init_frame…       starting frame number (default 1)</div>
<div class="line">slider_axis…      axis along which you want to use imagesc (default 3)</div>
<div class="line">fps…              frames per second (default 25); will be adjusted by a factor of 1.2 to account for internal overhead</div>
<div class="line">title_list…       individual title for each frame (default {})</div>
<div class="line">loop…             run in a loop (default false)</div>
<div class="line">reset_frame…      stop resets frame to init_frame (default false)</div>
<div class="line">autoplay…         stark movie automatically (default false)</div>
<div class="line">slider_position…  slider position [left bottom width height] (default center of axis)</div>
<div class="line">play_position…    play button position [left bottom width height]</div>
<div class="line">edit_position…    edit box position [left bottom width height]</div>
<div class="line">show_play_button… show/hide button; needs to be visible if loop=true; (default true)</div>
<div class="line">show_edit_box…    show/hide box</div>
<div class="line">fnct…             data processing function</div>
<div class="line">order…            change slice order in stack</div>
<div class="line">save_movie…       specify filename if a movie shall be written</div>
<div class="line">movie_quality…    image quality of the saved movie</div>
</div>
<div class="line-block">
<div class="line">Complex images will be converted to RGB using c2image.</div>
</div>
<div class="line-block">
<div class="line">If you are not using ‘autplay’, you can also set a global title instead</div>
<div class="line">of a title list (similar to imagesc) and use ‘%d’ to get the slice number</div>
<div class="line">title(‘Random block - slice %d’)</div>
</div>
<div class="line-block">
<div class="line">EXAMPLES:</div>
<div class="line">imagesc3D(rand(256, 256, 100), ‘fps’, 10, ‘loop’, true)</div>
<div class="line">imagesc3D(rand(256, 256)*1j)</div>
<div class="line">imagesc3D(rand(20, 256, 256), ‘slider_axis’, 1);</div>
</div>
<div class="line-block">
<div class="line">Additionally, you can use imagesc/imagesc3D routines and trigger the movie by</div>
<div class="line">calling the play method of a specified axis:</div>
</div>
<div class="line-block">
<div class="line">figure(1);</div>
<div class="line">imagesc3D(rand(256, 256, 100), ‘fps’, 20);</div>
<div class="line">title(‘Random block - slice %d’);</div>
<div class="line">colorbar();</div>
<div class="line">ax = gca;</div>
<div class="line">ax.play();</div>
</div>
</dd></dl>

<span class="target" id="base-plotting-imagesc-tomo"></span><dl class="function">
<dt id="plotting.imagesc_tomo">
<code class="descclassname">plotting.</code><code class="descname">imagesc_tomo</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.imagesc_tomo" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Function [im_out]=imagesc_tomo( varargin )</div>
<div class="line">Parameters:</div>
<div class="line">data - 3D array to be shown</div>
<div class="line">colormap - name of standard matlab colormap, default = bone</div>
<div class="line">clim - range of the colorbar, default is [] (auto range)</div>
<div class="line">axis - cell of strings with axis parameters, eg. {‘image’, ‘off’}</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">im_out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-integrate-frames"></span><dl class="function">
<dt id="plotting.integrate_frames">
<code class="descclassname">plotting.</code><code class="descname">integrate_frames</code><span class="sig-paren">(</span><em>base_path</em>, <em>scan_num</em>, <em>plotfigure</em>, <em>det_num</em>, <em>savedata</em>, <em>maskfile</em>, <em>masktype</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.integrate_frames" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Integrates frames from a loopscan</div>
</div>
<div class="line-block">
<div class="line">Syntax:</div>
<div class="line">[int] = integrate_frames(base_path,scan_num,plotfigure,det_num,savedata,maskfilename,masktype)</div>
<div class="line">Needed parameters: base_path (e.g. ‘~/Data10/’)</div>
<div class="line">scan_num   (scan number)</div>
<div class="line">Optional parameters: plotfigure (figure number for final plot, 0 for no plotting, by default is 0)</div>
<div class="line">det_num (detector number, default 1)</div>
<div class="line">savedata (=1 to save data in ‘analysis/integrated_frames/’, default 0)</div>
<div class="line">maskfilename (valid mask file name. If empty [], no mask used)</div>
<div class="line">masktype (type of valid mask file name: ‘bin’ for binary or ‘Oliver’)</div>
<div class="line">14-11-2012</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-integrated-intensity"></span><dl class="function">
<dt id="plotting.integrated_intensity">
<code class="descclassname">plotting.</code><code class="descname">integrated_intensity</code><span class="sig-paren">(</span><em>filename_mask</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.integrated_intensity" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int_int</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-plot-radial-integ"></span><dl class="function">
<dt id="plotting.plot_radial_integ">
<code class="descclassname">plotting.</code><code class="descname">plot_radial_integ</code><span class="sig-paren">(</span><em>filename_masks</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.plot_radial_integ" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x_values_returned, y_values_returned</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">plot_radial_integ_template</code></dt>
<dd><div class="line-block">
<div class="line">plotting.plot_radial_integ_template is a script.</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">plot_sgalil_positions</code></dt>
<dd><div class="line-block">
<div class="line">this script  is used to visualize  the sgalil positions</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">plot_sgalil_positions_step_by_step</code></dt>
<dd><div class="line-block">
<div class="line">this script is used to plot the sgalil positions in the order that they</div>
<div class="line">occur</div>
</div>
</dd></dl>

<span class="target" id="base-plotting-ptycho-show-recons"></span><dl class="function">
<dt id="plotting.ptycho_show_recons">
<code class="descclassname">plotting.</code><code class="descname">ptycho_show_recons</code><span class="sig-paren">(</span><em>file</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.ptycho_show_recons" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[p object probe] = ptycho_show_recons(file,param1,val1,…)</div>
<div class="line">Receives a path+filename, reads it and makes plots of the ptychography</div>
<div class="line">reconstruction</div>
<div class="line">Optional parameters</div>
<div class="line">‘imagesavefolder’   ‘~/Data10/analysis/online/ptycho/show_recons/’</div>
<div class="line">(default = [], which means no plot is saved)</div>
<div class="line">param can be updated with another struct</div>
<div class="line">[p, probe, object] = core.ptycho_show_recons(filepath, p_updated)</div>
</div>
<div class="line-block">
<div class="line">and / or with single field names</div>
<div class="line">[p, probe, object] = core.ptycho_show_recons(filepath, p_updated, ‘windowautopos’, 1, ‘extrastringtitle’, ‘Final recon’)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">p, object, probe</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-scan-movie"></span><dl class="function">
<dt id="plotting.scan_movie">
<code class="descclassname">plotting.</code><code class="descname">scan_movie</code><span class="sig-paren">(</span><em>filenames</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.scan_movie" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-spec-plot"></span><dl class="function">
<dt id="plotting.spec_plot">
<code class="descclassname">plotting.</code><code class="descname">spec_plot</code><span class="sig-paren">(</span><em>specDatFile</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.spec_plot" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function [varargout] = spec_plot(specDatFile, varargin)</div>
<div class="line">call ‘spec_plot()’ for further help</div>
</div>
<div class="line-block">
<div class="line">please reports bugs, problems, suggestions for improvements to:</div>
<div class="line">CXS group</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-suptitle"></span><dl class="function">
<dt id="plotting.suptitle">
<code class="descclassname">plotting.</code><code class="descname">suptitle</code><span class="sig-paren">(</span><em>str</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.suptitle" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Function modified by CXS group from:</div>
</div>
<div class="line-block">
<div class="line">SUPTITLE puts a title above all subplots.</div>
</div>
<div class="line-block">
<div class="line">SUPTITLE(‘text’) adds text to the top of the figure</div>
<div class="line">above all subplots (a “super title”). Use this function</div>
<div class="line">after all subplot commands.</div>
</div>
<div class="line-block">
<div class="line">SUPTITLE is a helper function for yeastdemo.</div>
<div class="line">Copyright 2003-2014 The MathWorks, Inc.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">hout</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">template_plot_radial_integ</code></dt>
<dd><div class="line-block">
<div class="line">plotting.template_plot_radial_integ is a script.</div>
</div>
</dd></dl>

<span class="target" id="base-plotting-tight-subplot"></span><dl class="function">
<dt id="plotting.tight_subplot">
<code class="descclassname">plotting.</code><code class="descname">tight_subplot</code><span class="sig-paren">(</span><em>Nh</em>, <em>Nw</em>, <em>gap</em>, <em>marg_h</em>, <em>marg_w</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.tight_subplot" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">tight_subplot creates “subplot” axes with adjustable gaps and margins</div>
</div>
<div class="line-block">
<div class="line">ha = tight_subplot(Nh, Nw, gap, marg_h, marg_w)</div>
</div>
<div class="line-block">
<div class="line">in:  Nh      number of axes in hight (vertical direction)</div>
<div class="line">Nw      number of axes in width (horizontaldirection)</div>
<div class="line">gap     gaps between the axes in normalized units (0…1)</div>
<div class="line">or [gap_h gap_w] for different gaps in height and width</div>
<div class="line">marg_h  margins in height in normalized units (0…1)</div>
<div class="line">or [lower upper] for different lower and upper margins</div>
<div class="line">marg_w  margins in width in normalized units (0…1)</div>
<div class="line">or [left right] for different left and right margins</div>
</div>
<div class="line-block">
<div class="line">out:  ha     array of handles of the axes objects</div>
<div class="line">starting from upper left corner, going row-wise as in</div>
<div class="line">going row-wise as in</div>
</div>
<div class="line-block">
<div class="line">Example: ha = tight_subplot(3,2,[.01 .03],[.1 .01],[.01 .01])</div>
<div class="line">for ii = 1:6; axes(ha(ii)); plot(randn(10,ii)); end</div>
<div class="line">set(ha(1:4),’XTickLabel’,’‘); set(ha,’YTickLabel’,’‘)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ha</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-plotting-vline"></span><dl class="function">
<dt id="plotting.vline">
<code class="descclassname">plotting.</code><code class="descname">vline</code><span class="sig-paren">(</span><em>x</em>, <em>in1</em>, <em>in2</em><span class="sig-paren">)</span><a class="headerlink" href="#plotting.vline" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function h=vline(x, linetype, label)</div>
</div>
<div class="line-block">
<div class="line">Draws a vertical line on the current axes at the location specified by ‘x’.  Optional arguments are</div>
<div class="line">‘linetype’ (default is ‘r:’) and ‘label’, which applies a text label to the graph near the line.  The</div>
<div class="line">label appears in the same color as the line.</div>
</div>
<div class="line-block">
<div class="line">The line is held on the current axes, and after plotting the line, the function returns the axes to</div>
<div class="line">its prior hold state.</div>
</div>
<div class="line-block">
<div class="line">The HandleVisibility property of the line object is set to “off”, so not only does it not appear on</div>
<div class="line">legends, but it is not findable by using findobj.  Specifying an output argument causes the function to</div>
</div>
<div class="line-block">
<div class="line">overridden by setting the root’s ShowHiddenHandles property to on.</div>
</div>
<div class="line-block">
<div class="line">h = vline(42,’g’,’The Answer’)</div>
</div>
<div class="line-block">
<div class="line">the current axes, close to the line, which reads “The Answer”.</div>
</div>
<div class="line-block">
<div class="line">vline also supports vector inputs to draw multiple lines at once.  For example,</div>
</div>
<div class="line-block">
<div class="line">vline([4 8 12],{‘g’,’r’,’b’},{‘l1’,’lab2’,’LABELC’})</div>
</div>
<div class="line-block">
<div class="line">draws three lines with the appropriate labels and colors.</div>
</div>
<div class="line-block">
<div class="line">By Brandon Kuczenski for Kensington Labs.</div>
<div class="line"><a class="reference external" href="mailto:brandon_kuczenski&#37;&#52;&#48;kensingtonlabs&#46;com">brandon_kuczenski<span>&#64;</span>kensingtonlabs<span>&#46;</span>com</a></div>
<div class="line">8 November 2001</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">hhh</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="utils">
<h2>+utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h2>
<span class="target" id="base-utils-abspath"></span><dl class="function">
<dt id="utils.abspath">
<code class="descclassname">utils.</code><code class="descname">abspath</code><span class="sig-paren">(</span><em>filename_with_path</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.abspath" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION filename_with_path = abspath(filename_with_path)</div>
<div class="line">translate special symbols such as ~, ../, ./, in path to the absolute</div>
<div class="line">path</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">filename_with_path</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-add-to-3d-projection"></span><dl class="function">
<dt id="utils.add_to_3D_projection">
<code class="descclassname">utils.</code><code class="descname">add_to_3D_projection</code><span class="sig-paren">(</span><em>small_array</em>, <em>full_array</em>, <em>positions</em>, <em>indices</em>, <em>add_values</em>, <em>use_MEX</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.add_to_3D_projection" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">full_array = add_to_3D_projection(small_array,full_array, positions, indices,add_values)</div>
<div class="line">add one small 3D block into large 3D array</div>
<div class="line">Inputs:</div>
<div class="line">full_array - array to which the small_array will be added / written</div>
<div class="line">small_array - array used to be added to large array</div>
<div class="line">positions - [Nangles x 2] offset from (1,1) coordinate in pixels</div>
<div class="line">for each slice</div>
<div class="line">indices - add only to selected sliced of the full_array</div>
<div class="line">add_values - add values instead of rewritting</div>
<div class="line">Compilation from Matlab:</div>
<div class="line">mex -R2018a ‘CFLAGS=”.. _base_utils.adjust_projection:</div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.adjust_projection">
<code class="descclassname">utils.</code><code class="descname">adjust_projection</code><span class="sig-paren">(</span><em>input</em>, <em>snake_scan</em>, <em>fast_axis_x</em>, <em>positions</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.adjust_projection" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function used to correct the image orientation of mcs_mesh data.</div>
<div class="line">[output, output_pos] = adjust_projection(input, snake_scan, fast_axis_x, positions)</div>
<div class="line">input = data to be corrected. For mcs the data should be a 2D matrix.</div>
<div class="line">snake_scan = 0 for off and 1 for on</div>
<div class="line">fast_axis_x = 1 for fast axis along x, 0 for fast axis along y</div>
</div>
<div class="line-block">
<div class="line">output = corrected data</div>
<div class="line">output_pos = corrected output positions, could be used to see if</div>
<div class="line">there was a problem with the correction</div>
<div class="line">For snake scans the routine decides the flipping based on the positions</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">output, output_pos</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-auto-mask-find"></span><dl class="function">
<dt id="utils.auto_mask_find">
<code class="descclassname">utils.</code><code class="descname">auto_mask_find</code><span class="sig-paren">(</span><em>im</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.auto_mask_find" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">mask = auto_mask_find(im,[&lt;name&gt;,&lt;value&gt;])</div>
</div>
<div class="line-block">
<div class="line">im    Input complex valued image</div>
</div>
<div class="line-block">
<div class="line">Optional parameters:</div>
</div>
<div class="line-block">
<div class="line">margins   Two element array that indicates the (y,x) margins to exclude</div>
<div class="line">from the edge of the mask window. For example to exclude the</div>
<div class="line">noise around ptychography reconstructions, default 0.</div>
<div class="line">smoothing     Size of averaging window on the phase derivative, default</div>
<div class="line">10.</div>
<div class="line">gradientrange Size of the histogram windown when selecting valid gradient</div>
<div class="line">regions, in radians per pixel, default 1;</div>
<div class="line">show_bivariate    Show the bivariate histogram of the gradient, useful</div>
<div class="line">for debugging. Set to the number of figure you’d like</div>
<div class="line">it to appear.</div>
</div>
<div class="line-block">
<div class="line">Morphological operations to remove point details in the mask</div>
</div>
<div class="line-block">
<div class="line">close_size    Size of closing window, removes dark bubbles from the mask,</div>
<div class="line">default 15.  ( = 1 for no effect)</div>
<div class="line">open_size     Size of opening window, removes bright bubbles from mask,</div>
<div class="line">default 120. ( = 1 for no effect)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mask</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-binning-2d"></span><dl class="function">
<dt id="utils.binning_2D">
<code class="descclassname">utils.</code><code class="descname">binning_2D</code><span class="sig-paren">(</span><em>x</em>, <em>binning</em>, <em>centered</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.binning_2D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION x = binning_2D(x, binning)</div>
<div class="line">perform binning in first two dimensions</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-binning-3d"></span><dl class="function">
<dt id="utils.binning_3D">
<code class="descclassname">utils.</code><code class="descname">binning_3D</code><span class="sig-paren">(</span><em>x</em>, <em>binning</em>, <em>centered</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.binning_3D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION x = binning_3D(x, binning)</div>
<div class="line">perform fast binning in three dimensions</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">x</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-char-to-cellstr"></span><dl class="function">
<dt id="utils.char_to_cellstr">
<code class="descclassname">utils.</code><code class="descname">char_to_cellstr</code><span class="sig-paren">(</span><em>inchars</em>, <em>nl_only</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.char_to_cellstr" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[outstr] = char_to_cellstr(inchars,nl_only)</div>
<div class="line">Convert an array of text to a cell array of lines.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">outstr</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-check-available-memory"></span><dl class="function">
<dt id="utils.check_available_memory">
<code class="descclassname">utils.</code><code class="descname">check_available_memory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.check_available_memory" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION [mem_avail, mem_total] = check_availible_memory()</div>
<div class="line">get availible free memory in linux in MB</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-check-cpu-load"></span><dl class="function">
<dt id="utils.check_cpu_load">
<code class="descclassname">utils.</code><code class="descname">check_cpu_load</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.check_cpu_load" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">CHECK_CPU_LOAD returns user cpu usage of specified hosts</div>
</div>
<div class="line-block">
<div class="line">hosts (optional)…       list of nodes; use ‘x12sa’ for all x12sa nodes</div>
<div class="line">used_nodes (optional)…  prints warning/summary for used nodes (default: true)</div>
<div class="line">ssh_auth (optional) …   system echo if ssh authentication is needed (default: false)</div>
<div class="line">thr (optional)…         set threshold for used nodes (default: 15 %)</div>
<div class="line">vm_cycles (optional)…   number of cycles for cpu usage (default: 2)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">cpu_load_bl, any_used_cpu</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-check-matlab-version"></span><dl class="function">
<dt id="utils.check_matlab_version">
<code class="descclassname">utils.</code><code class="descname">check_matlab_version</code><span class="sig-paren">(</span><em>ver</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.check_matlab_version" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">CHECK_MATLAB_VERSION check matlab version to make sure it is compatible</div>
<div class="line">ver…    compatible version number</div>
</div>
<div class="line-block">
<div class="line">EXAMPLE:</div>
<div class="line">check_matlab_version(9.2)</div>
</div>
<div class="line-block">
<div class="line">MATLAB 9.0 - 2016a</div>
<div class="line">MATLAB 9.1 - 2016b</div>
<div class="line">MATLAB 9.2 - 2017a</div>
<div class="line">MATLAB 9.3 - 2017b</div>
</div>
</dd></dl>

<span class="target" id="base-utils-check-perm"></span><dl class="function">
<dt id="utils.check_perm">
<code class="descclassname">utils.</code><code class="descname">check_perm</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.check_perm" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">CHECK_PERM check r w x permissions for given path</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">result</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-compile-x12sa-dirname"></span><dl class="function">
<dt id="utils.compile_x12sa_dirname">
<code class="descclassname">utils.</code><code class="descname">compile_x12sa_dirname</code><span class="sig-paren">(</span><em>scan_no</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.compile_x12sa_dirname" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">COMPILE_X12SA_DIRNAME returns the default cSAXS directory tree for a</div>
<div class="line">given scan number</div>
</div>
<div class="line-block">
<div class="line">EXAMPLE:</div>
<div class="line">scan_dir = utils.compile_x12sa_dirname(10);</div>
<div class="line">-&gt; scan_dir = ‘S00000-00999/S00010/’</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">scan_dir</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-compile-x12sa-filename"></span><dl class="function">
<dt id="utils.compile_x12sa_filename">
<code class="descclassname">utils.</code><code class="descname">compile_x12sa_filename</code><span class="sig-paren">(</span><em>scan_no</em>, <em>point_no</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.compile_x12sa_filename" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">filename, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-crop-pad"></span><dl class="function">
<dt id="utils.crop_pad">
<code class="descclassname">utils.</code><code class="descname">crop_pad</code><span class="sig-paren">(</span><em>img</em>, <em>outsize</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.crop_pad" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">CROP_PAD adjusts the size by zero padding or cropping</div>
</div>
<div class="line-block">
<div class="line">img…                input image</div>
<div class="line">outsize…            size of final image</div>
<div class="line">(fill)…             value to fill padded regions</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">imout</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">default_parameter_value</code></dt>
<dd><div class="line-block">
<div class="line">[default_value] = default_parameter_value(mfile_name,parameter_name,vararg)</div>
<div class="line">identify the current system to set useful default parameters</div>
</div>
</dd></dl>

<span class="target" id="base-utils-dftregistration"></span><dl class="function">
<dt id="utils.dftregistration">
<code class="descclassname">utils.</code><code class="descname">dftregistration</code><span class="sig-paren">(</span><em>buf1ft</em>, <em>buf2ft</em>, <em>usfac</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.dftregistration" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function [output Greg] = dftregistration(buf1ft,buf2ft,usfac);</div>
<div class="line">Efficient subpixel image registration by crosscorrelation. This code</div>
<div class="line">gives the same precision as the FFT upsampled cross correlation in a</div>
<div class="line">small fraction of the computation time and with reduced memory</div>
<div class="line">requirements. It obtains an initial estimate of the crosscorrelation peak</div>
<div class="line">by an FFT and then refines the shift estimation by upsampling the DFT</div>
<div class="line">only in a small neighborhood of that estimate by means of a</div>
<div class="line">matrix-multiply DFT. With this procedure all the image points are used to</div>
<div class="line">compute the upsampled crosscorrelation.</div>
<div class="line">Manuel Guizar - Dec 13, 2007</div>
</div>
<div class="line-block">
<div class="line">Rewrote all code not authored by either Manuel Guizar or Jim Fienup</div>
<div class="line">Manuel Guizar - May 13, 2016</div>
</div>
<div class="line-block">
<div class="line">Citation for this algorithm:</div>
<div class="line">Manuel Guizar-Sicairos, Samuel T. Thurman, and James R. Fienup,</div>
<div class="line">“Efficient subpixel image registration algorithms,” Opt. Lett. 33,</div>
<div class="line">156-158 (2008).</div>
</div>
<div class="line-block">
<div class="line">Inputs</div>
<div class="line">buf1ft    Fourier transform of reference image,</div>
<div class="line">DC in (1,1)   [DO NOT FFTSHIFT]</div>
<div class="line">buf2ft    Fourier transform of image to register,</div>
<div class="line">DC in (1,1) [DO NOT FFTSHIFT]</div>
<div class="line">usfac     Upsampling factor (integer). Images will be registered to</div>
<div class="line">within 1/usfac of a pixel. For example usfac = 20 means the</div>
<div class="line">images will be registered within 1/20 of a pixel. (default = 1)</div>
</div>
<div class="line-block">
<div class="line">Outputs</div>
<div class="line">output =  [error,diffphase,net_row_shift,net_col_shift]</div>
<div class="line">error     Translation invariant normalized RMS error between f and g</div>
<div class="line">diffphase     Global phase difference between the two images (should be</div>
<div class="line">zero if images are non-negative).</div>
<div class="line">net_row_shift net_col_shift   Pixel shifts between images</div>
<div class="line">Greg      (Optional) Fourier transform of registered version of buf2ft,</div>
<div class="line">the global phase difference is compensated for.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">output Greg</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-dose-calc"></span><dl class="function">
<dt id="utils.dose_calc">
<code class="descclassname">utils.</code><code class="descname">dose_calc</code><span class="sig-paren">(</span><em>ptycho_recon</em>, <em>ptycho_data</em>, <em>param</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.dose_calc" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line">Function:</div>
</div>
<div class="line-block">
<div class="line">dose_calc(ptycho_recon, ptycho_data, param)</div>
</div>
<div class="line-block">
<div class="line">Description:</div>
</div>
<div class="line-block">
<div class="line">The function (1) takes one reconstruction and its data and estimate the</div>
<div class="line">dose (2) saves the dose estimation into a .txt file.</div>
</div>
<div class="line-block">
<div class="line">Input:</div>
</div>
<div class="line-block">
<div class="line">ptycho_recon: reconstruction, including object, probe, and p</div>
<div class="line">ptycho_data: data for the reconstruction</div>
<div class="line">param_dose.mu = 1/(451*1e-6);     % 1/attenuation_length   in 1/m   (for CH2 &#64;6.2keV)</div>
<div class="line">% 1/(152.7*1e-6) for zeolite Na2Al2Si3O102H4O with 2 g/cm3 density at 6.2 keV</div>
<div class="line">param_dose.rho = 1000;            % Density in kg/m^3</div>
<div class="line">param_dose.setup_transmission = 0.55; % Intensity transmission of sample</div>
<div class="line">% (e.g. air path after the sample, windows, He, detector efficiency)</div>
<div class="line">% 0.943 for 700 cm He gas at 760 Torr and 295 K &#64; 6.2 keV</div>
<div class="line">% 0.780 for 10 cm air at 760 Torr and 295 K &#64; 6.2 keV</div>
<div class="line">% 0.976 for 13 micron Kapton (polymide) with 1.43</div>
<div class="line">% g/cm3 &#64; 6.2 keV</div>
<div class="line">% 0.841 for 7 micron muskovite mica</div>
<div class="line">% (KAl3Si3O11.8H1.8F0.2) with 2.76 g/cm3 &#64; 6.2 keV</div>
<div class="line">% 0.914 for 5 cm of air at 6.2 keV 750 Torr 295 K</div>
<div class="line">% 0.55 for 300 micron of mylar C10H8O4 with density 1.38 g/cm3 at 6.2 keV</div>
<div class="line">param_dose.overhead = 0.0;    % Extra dose during movement overhead, only applicable</div>
<div class="line">% if shutter is not closed between exposures</div>
<div class="line">param_dose.fmask</div>
<div class="line">param_dose.scan_number</div>
<div class="line">param_dose.num_proj</div>
<div class="line">param_dose.output_folder (default: ./)</div>
</div>
<div class="line-block">
<div class="line">Output:</div>
</div>
<div class="line-block">
<div class="line">one jpg for one_data_frame</div>
<div class="line">one jpg for photons_per_shot_all</div>
<div class="line">one jpg for photons_per_obj_pix</div>
<div class="line">one txt for dose_estimate</div>
</div>
<div class="line-block">
<div class="line">2017-03-30</div>
<div class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
</div>
</dd></dl>

<span class="target" id="base-utils-filt2d"></span><dl class="function">
<dt id="utils.filt2d">
<code class="descclassname">utils.</code><code class="descname">filt2d</code><span class="sig-paren">(</span><em>outputdim</em>, <em>unmodsize</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.filt2d" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FILT2D creates a 2d filter, based on fract_hanning</div>
</div>
<div class="line-block">
<div class="line">outputdim…                Size of the output array.</div>
<div class="line">unmodsize…                Size of the central array containing no modulation.</div>
<div class="line">shape (optional)…         ‘rect’ (default) or ‘circ’</div>
<div class="line">filter_type (optional)…   ‘hann’ (default) or ‘hamm’, chebishev (only for unmodsize=0)</div>
</div>
<div class="line-block">
<div class="line">example:</div>
<div class="line">filt1 = filt2d(256,100,’circ’,’hann’);</div>
<div class="line">filt2 = filt2d(256,100);</div>
</div>
<div class="line-block">
<div class="line">Adapted from fract_hanning:</div>
</div>
<div class="line-block">
<div class="line">fract_hanning(outputdim,unmodsize)</div>
<div class="line">out = Square array containing a fractional separable Hanning window with</div>
<div class="line">DC in upper left corner.</div>
<div class="line">outputdim = size of the output array</div>
<div class="line">unmodsize = Size of the central array containing no modulation.</div>
<div class="line">Creates a square hanning window if unmodsize = 0 (or ommited), otherwise the output array</div>
<div class="line">will contain an array of ones in the center and cosine modulation on the</div>
<div class="line">edges, the array of ones will have DC in upper left corner.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-filt2d-pad"></span><dl class="function">
<dt id="utils.filt2d_pad">
<code class="descclassname">utils.</code><code class="descname">filt2d_pad</code><span class="sig-paren">(</span><em>outputdim</em>, <em>filterdim</em>, <em>unmodsize</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.filt2d_pad" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">filt2d_pad(outputdim,filterdim,unmodsize)</div>
<div class="line">out = Square array containing a fractional separable Hanning window with</div>
<div class="line">DC in upper left corner.</div>
<div class="line">outputdim = size of the output array</div>
<div class="line">filterdim = size of filter (it will zero pad if filterdim&lt;outputdim</div>
<div class="line">unmodsize = Size of the central array containing no modulation.</div>
<div class="line">Creates a square hanning window if unmodsize = 0 (or ommited), otherwise the output array</div>
<div class="line">will contain an array of ones in the center and cosine modulation on the</div>
<div class="line">edges, the array of ones will have DC in upper left corner.</div>
<div class="line">Code based in fract_hanning_pad</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-find-files"></span><dl class="function">
<dt id="utils.find_files">
<code class="descclassname">utils.</code><code class="descname">find_files</code><span class="sig-paren">(</span><em>filename_mask</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.find_files" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">directory, fnames, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-find-latest-file"></span><dl class="function">
<dt id="utils.find_latest_file">
<code class="descclassname">utils.</code><code class="descname">find_latest_file</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.find_latest_file" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FIND_LATEST_FILE find latest file in given directory and return path</div>
</div>
<div class="line-block">
<div class="line"><em>optional input</em></div>
<div class="line">path…                     search path; default ‘./’</div>
<div class="line">file mask…                limit results to a specific name or file</div>
<div class="line">extension; default none</div>
<div class="line">offset…                   take latest-offset; default 0</div>
</div>
<div class="line-block">
<div class="line">EXAMPLE:</div>
<div class="line">out = find_latest_file;</div>
<div class="line">out = find_latest_file(‘../analysis’);</div>
<div class="line">out = find_latest_file(‘../analysis’, ‘<a href="#id7"><span class="problematic" id="id8">*</span></a>.h5’);</div>
<div class="line">out = find_latest_file(‘../analysis’, ‘<em>recons</em>.h5’);</div>
<div class="line">out = find_latest_file(‘../analysis’, {<em>recons</em>.h5, <em>recons</em>.mat});</div>
<div class="line">out = find_latest_file(‘../analysis’, ‘<a href="#id9"><span class="problematic" id="id10">*</span></a>.h5’, -2);</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-find-package-refs"></span><dl class="function">
<dt id="utils.find_package_refs">
<code class="descclassname">utils.</code><code class="descname">find_package_refs</code><span class="sig-paren">(</span><em>base_path</em>, <em>path</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.find_package_refs" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FIND_PACKAGE_REFS update references in &lt;path&gt; and its subfolders to</div>
<div class="line">package structure in &lt;base_path&gt;.</div>
</div>
<div class="line-block">
<div class="line">base_path…        repository with new package structure</div>
<div class="line">path…             repository which needs to be updated</div>
</div>
<div class="line-block">
<div class="line"><em>optional</em>          given as name/value pair</div>
<div class="line">extension…        file extension; default ‘.m’</div>
<div class="line">recursive…        recursive behavior; default false</div>
<div class="line">show_files…       show file names, otherwise progressbar; default false</div>
<div class="line">filename…         change output file name and path; default</div>
<div class="line">./references.txt</div>
</div>
<div class="line-block">
<div class="line">Example:</div>
<div class="line">find_package_refs(‘./cSAXS_matlab_base’, ‘./cSAXS_matlab_ptycho’)</div>
<div class="line">find_package_refs(‘./cSAXS_matlab_base’, ‘./cSAXS_matlab_ptycho’, ‘recursive’, false);</div>
</div>
</dd></dl>

<span class="target" id="base-utils-findresidues"></span><dl class="function">
<dt id="utils.findresidues">
<code class="descclassname">utils.</code><code class="descname">findresidues</code><span class="sig-paren">(</span><em>phase</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.findresidues" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function residues = findresidues(phase)</div>
<div class="line">Receives phase in radians, returns map of residues</div>
<div class="line">Manuel Guizar - Sept 27, 2011</div>
<div class="line">R. M. Goldstein, H. A. Zebker and C. L. Werner, Radio Science 23, 713-720</div>
<div class="line">(1988).</div>
<div class="line">Inputs</div>
<div class="line">phase      Phase in radians</div>
<div class="line">disp      = 0, No feedback</div>
<div class="line">= 1, Text feedback (additional computation)</div>
<div class="line">= 2, Text and graphic display (additional computation)</div>
<div class="line">Outputs</div>
<div class="line">residues  Map of residues, note they are valued +1 or -1</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">residues</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-focus-series-fit"></span><dl class="function">
<dt id="utils.focus_series_fit">
<code class="descclassname">utils.</code><code class="descname">focus_series_fit</code><span class="sig-paren">(</span><em>scans</em>, <em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.focus_series_fit" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function [ out ] = focus_series_fit( scans, p )</div>
<div class="line">Receives scan numbers and parameters as a structure p</div>
<div class="line">Input:</div>
<div class="line">scans</div>
<div class="line">For SPEC variables</div>
<div class="line">p.motor_name    From SPEC</div>
<div class="line">p.counter       From SPEC</div>
<div class="line">For sgalil position file</div>
<div class="line">p.position_file     Example  ‘~/Data10/sgalil/S%05d.dat’</div>
<div class="line">p.fast_axis_index   (= 1 or 2) for x or y scan respectively</div>
<div class="line">For mcs counter</div>
<div class="line">p.mcs_file          Example sprintf(‘~/Data10/mcs/S%02d000-%02d999/S%%05d/%s_%%05d.dat’,floor(scans(ii)/1000),floor(scans(ii)/1000),beamline.identify_eaccount);</div>
<div class="line">p.mcs_channel       Channel number, e.g. = 3</div>
</div>
<div class="line-block">
<div class="line">Optional</div>
<div class="line">p.motor_units</div>
<div class="line">p.plot</div>
<div class="line">p.title_str</div>
<div class="line">p.coarse_motor</div>
</div>
<div class="line-block">
<div class="line">Output</div>
<div class="line">out.fitout        Parameters of quadratic fit</div>
<div class="line">out.coarse_motor  Coarse motor name is passed back</div>
<div class="line">out.fwhm          A vector with the fwhm for each scan</div>
<div class="line">out.vertex        The position of  coarse motor with minimum fwhm from the quadratic fit</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">focus_series_template</code></dt>
<dd><div class="line-block">
<div class="line">A script to analyze vertica and horizontal through focus scans to</div>
<div class="line">determine the size and position of the horizontal and vertical focii</div>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">follow_feature</code></dt>
<dd><div class="line-block">
<div class="line">% Following a feature</div>
</div>
</dd></dl>

<span class="target" id="base-utils-fopen-until-exists"></span><dl class="function">
<dt id="utils.fopen_until_exists">
<code class="descclassname">utils.</code><code class="descname">fopen_until_exists</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.fopen_until_exists" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">fid, vararg_remain</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-fourier-shell-corr-3d-2"></span><dl class="function">
<dt id="utils.fourier_shell_corr_3D_2">
<code class="descclassname">utils.</code><code class="descname">fourier_shell_corr_3D_2</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>param</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.fourier_shell_corr_3D_2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[resolution FSC T freq n stat] = fourier_shell_corr_3D_2(img1,img2,param, varargin)</div>
<div class="line">Computes the Fourier shell correlation between img1 and img2. It can also</div>
<div class="line">compute the threshold function T. Images can be complex-valued.</div>
<div class="line">Can handle non-cube arrays but assumes the voxel is isotropic</div>
</div>
<div class="line-block">
<div class="line">Inputs:</div>
<div class="line">img1, img2        Compared images</div>
<div class="line">param             Structure containing parameters</div>
<div class="line">Parameters:</div>
<div class="line">dispfsc = 1;      Display results</div>
<div class="line">SNRt = 0.5        Power SNR for threshold, popular options:</div>
<div class="line">SNRt = 0.5;      1 bit threshold for average</div>
<div class="line">SNRt = 0.2071;   1/2 bit threshold for average</div>
<div class="line">thickring         Normally the pixels get assigned to the closest integer pixel ring in Fourier domain.</div>
<div class="line">With thickring the thickness of the rings is increased by</div>
<div class="line">thickring, so each ring gets more pixels and more statistics</div>
<div class="line">auto_thickring    do not calculate overlaps if thickring &gt; 1 is used</div>
<div class="line">st_title          optional extra title in the plot</div>
<div class="line">freq_thr =0.05    mimimal freq value above which the resolution is detected</div>
<div class="line">show_fourier_corr show 2D Fourier correlation</div>
<div class="line">mask              bool array equal to false for ignored pixels of the fft space</div>
</div>
<div class="line-block">
<div class="line">Outputs:</div>
<div class="line">resolution        [min, max] resolution estimated from FSC curve</div>
<div class="line">FSC               FSC curve values</div>
<div class="line">T                 Threshold values</div>
<div class="line">freq              spatial frequencies</div>
<div class="line">stat              stat - structure containing other statistics such as</div>
<div class="line">SSNR, area under FSC curve. average SNR, ….</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">resolution FSC T freq n stat</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-fract-hanning"></span><dl class="function">
<dt id="utils.fract_hanning">
<code class="descclassname">utils.</code><code class="descname">fract_hanning</code><span class="sig-paren">(</span><em>outputdim</em>, <em>unmodsize</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.fract_hanning" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">fract_hanning(outputdim,unmodsize)</div>
<div class="line">out = Square array containing a fractional separable Hanning window with</div>
<div class="line">DC in upper left corner.</div>
<div class="line">outputdim = size of the output array</div>
<div class="line">unmodsize = Size of the central array containing no modulation.</div>
<div class="line">Creates a square hanning window if unmodsize = 0 (or ommited), otherwise the output array</div>
<div class="line">will contain an array of ones in the center and cosine modulation on the</div>
<div class="line">edges, the array of ones will have DC in upper left corner.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-fract-hanning-pad"></span><dl class="function">
<dt id="utils.fract_hanning_pad">
<code class="descclassname">utils.</code><code class="descname">fract_hanning_pad</code><span class="sig-paren">(</span><em>outputdim</em>, <em>filterdim</em>, <em>unmodsize</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.fract_hanning_pad" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">fract_hanning_pad(outputdim,filterdim,unmodsize)</div>
<div class="line">out = Square array containing a fractional separable Hanning window with</div>
<div class="line">DC in upper left corner.</div>
<div class="line">outputdim = size of the output array</div>
<div class="line">filterdim = size of filter (it will zero pad if filterdim&lt;outputdim</div>
<div class="line">unmodsize = Size of the central array containing no modulation.</div>
<div class="line">Creates a square hanning window if unmodsize = 0 (or ommited), otherwise the output array</div>
<div class="line">will contain an array of ones in the center and cosine modulation on the</div>
<div class="line">edges, the array of ones will have DC in upper left corner.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-get-att-length"></span><dl class="function">
<dt id="utils.get_att_length">
<code class="descclassname">utils.</code><code class="descname">get_att_length</code><span class="sig-paren">(</span><em>formula</em>, <em>energy</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_att_length" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">GET_ATT_LENGTH returns attenuation length of a material for a given energy (range)</div>
<div class="line">formula…              chemical formula</div>
<div class="line">energy…               single value in keV or energy range in keV</div>
<div class="line">(optional) dens…      density, negative number for default values</div>
<div class="line">(optional) ang…       grazing angle (default 90)</div>
<div class="line">(optional) npts…      number of points</div>
<div class="line">(optional) plot…      set to 1 for plotting</div>
</div>
<div class="line-block">
<div class="line">att…            (energy in keV, transmission)</div>
<div class="line">req_density…      density in g/cm^3</div>
</div>
<div class="line-block">
<div class="line">examples:</div>
<div class="line">get_att_length(‘Au’, 8.7, -1, 45)</div>
<div class="line">get_att_length(‘Pb’, [11.2 24], 0.1, -1, 100)</div>
</div>
<div class="line-block">
<div class="line">03/2017</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">att, req_density</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-get-beam-center"></span><dl class="function">
<dt id="utils.get_beam_center">
<code class="descclassname">utils.</code><code class="descname">get_beam_center</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_beam_center" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for a detailed explanation of its use</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">center_xy</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-get-fil-trans"></span><dl class="function">
<dt id="utils.get_fil_trans">
<code class="descclassname">utils.</code><code class="descname">get_fil_trans</code><span class="sig-paren">(</span><em>formula</em>, <em>energy</em>, <em>thickness</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_fil_trans" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">GET_FIL_TRANS returns transmission of a solid for a given energy (range)</div>
<div class="line">formula…              chemical formula</div>
<div class="line">energy…               single value in keV or energy range in keV</div>
<div class="line">thickness…            thickness in micron</div>
<div class="line">(optional) dens…      density, negative number for default values</div>
<div class="line">(optional) npts…      number of points</div>
<div class="line">(optional) plot…      set to 1 for plotting</div>
</div>
<div class="line-block">
<div class="line">trans…            (energy in keV, transmission)</div>
<div class="line">req_density…      density in g/cm^3</div>
</div>
<div class="line-block">
<div class="line">examples:</div>
<div class="line">get_fil_trans(‘Au’, 8.7, 2)</div>
<div class="line">get_fil_trans(‘Pb’, [11.2 24], 0.1, -1, 100)</div>
</div>
<div class="line-block">
<div class="line">03/2017</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">trans, req_density</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-get-from-3d-projection"></span><dl class="function">
<dt id="utils.get_from_3D_projection">
<code class="descclassname">utils.</code><code class="descname">get_from_3D_projection</code><span class="sig-paren">(</span><em>small_array</em>, <em>full_array</em>, <em>positions</em>, <em>indices</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_from_3D_projection" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">full_array = get_from_3D_projection(small_array,full_array, positions, indices)</div>
<div class="line">add one small 3D block into large 3D array</div>
</div>
<div class="line-block">
<div class="line">Inputs:</div>
<div class="line">full_array - array from which the small_array will loaded</div>
<div class="line">small_array - empty array for storing the data</div>
<div class="line">positions - [Nangles x 2] offset from (1,1) coordinate in pixels</div>
<div class="line">for each slice</div>
<div class="line">indices - add only to selected sliced of the full_array</div>
<div class="line">Compilation from Matlab:</div>
<div class="line">mex -R2018a ‘CFLAGS=”.. _base_utils.get_gas_trans:</div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.get_gas_trans">
<code class="descclassname">utils.</code><code class="descname">get_gas_trans</code><span class="sig-paren">(</span><em>formula</em>, <em>energy</em>, <em>thickness</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_gas_trans" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">GET_GAS_TRANS returns transmission of a solid for a given energy (range)</div>
<div class="line">formula…              chemical formula</div>
<div class="line">energy…               single value in keV or energy range in keV</div>
<div class="line">thickness…            thickness in cm</div>
<div class="line">(optional) press…     pressure in Torr (default 30)</div>
<div class="line">(optional) tempr…     temperature in Kelvin (default 295)</div>
<div class="line">(optional) npts…      number of points</div>
<div class="line">(optional) plot…      set to 1 for plotting</div>
</div>
<div class="line-block">
<div class="line">trans…            (energy in keV, transmission)</div>
<div class="line">req_press…        pressure</div>
</div>
<div class="line-block">
<div class="line">examples:</div>
<div class="line">get_gas_trans(‘Air’, 8.7, 2)</div>
<div class="line">get_gas_trans(‘CO2’, [11.2 24], 20, 30, 100)</div>
</div>
<div class="line-block">
<div class="line">03/2017</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">trans, req_press</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-get-grid"></span><dl class="function">
<dt id="utils.get_grid">
<code class="descclassname">utils.</code><code class="descname">get_grid</code><span class="sig-paren">(</span><em>ish</em>, <em>px</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_grid" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">get_grid returns coordinate system for input shape ish and pixel size px</div>
</div>
<div class="line-block">
<div class="line">Example:</div>
<div class="line">[g1,g2] = get_grid(512, 29e-9);</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">gx, gy</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-get-hdr-val"></span><dl class="function">
<dt id="utils.get_hdr_val">
<code class="descclassname">utils.</code><code class="descname">get_hdr_val</code><span class="sig-paren">(</span><em>header</em>, <em>signature</em>, <em>format</em>, <em>...</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_hdr_val" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">outval, line_number, err</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-get-option"></span><dl class="function">
<dt id="utils.get_option">
<code class="descclassname">utils.</code><code class="descname">get_option</code><span class="sig-paren">(</span><em>p</em>, <em>option_name</em>, <em>default</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_option" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">bool = get_option(p, option_name, default)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-get-ref-index"></span><dl class="function">
<dt id="utils.get_ref_index">
<code class="descclassname">utils.</code><code class="descname">get_ref_index</code><span class="sig-paren">(</span><em>formula</em>, <em>energy</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_ref_index" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">GET_REF_INDEX returns refractive index for the specified chemical formula at a given energy (range)</div>
<div class="line">formula…              chemical formula</div>
<div class="line">energy…               single value in keV or energy range in keV</div>
<div class="line">(optional) dens…      density, negative number for default value</div>
<div class="line">(optional) npts…      number of points</div>
<div class="line">(optional) plot…      set to 1 for plotting the refractive index</div>
</div>
<div class="line-block">
<div class="line">ref…              (energy in keV, delta, beta)</div>
<div class="line">req_density…      density in g/cm^3</div>
</div>
<div class="line-block">
<div class="line">examples:</div>
<div class="line">get_ref_index(‘Au’, 8.7)</div>
<div class="line">get_ref_index(‘Pb’, [11.2 24], -1, 100)</div>
</div>
<div class="line-block">
<div class="line">03/2017</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ref, req_density</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-goldstein-unwrap2d"></span><dl class="function">
<dt id="utils.goldstein_unwrap2D">
<code class="descclassname">utils.</code><code class="descname">goldstein_unwrap2D</code><span class="sig-paren">(</span><em>a</em>, <em>max_box_radius</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.goldstein_unwrap2D" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line">GoldsteinUnwrap2D implements 2D Goldstein branch cut phase unwrapping algorithm.</div>
</div>
<div class="line-block">
<div class="line">References::</div>
<div class="line">1. R. M. Goldstein, H. A. Zebken, and C. L. Werner, �Satellite radar interferometry:</div>
<div class="line">Two-dimensional phase unwrapping,� Radio Sci., vol. 23, no. 4, pp. 713�720, 1988.</div>
<div class="line">2. D. C. Ghiglia and M. D. Pritt, Two-Dimensional Phase Unwrapping:</div>
<div class="line">Theory, Algorithms and Software. New York: Wiley-Interscience, 1998.</div>
</div>
<div class="line-block">
<div class="line">Inputs: 1. Complex image in .mat double format</div>
<div class="line">2. Binary mask (optional)</div>
<div class="line">Outputs: 1. Unwrapped phase image</div>
<div class="line">2. Phase quality map</div>
</div>
<div class="line-block">
<div class="line">This code can easily be extended for 3D phase unwrapping.</div>
<div class="line">Posted by Bruce Spottiswoode on 22 December 2008</div>
<div class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">unph</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-goldsteinunwrap2"></span><dl class="function">
<dt id="utils.goldsteinunwrap2">
<code class="descclassname">utils.</code><code class="descname">goldsteinunwrap2</code><span class="sig-paren">(</span><em>fase</em>, <em>disp</em>, <em>start</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.goldsteinunwrap2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Implementation of Goldstein unwrap algorithm based on location of</div>
<div class="line">residues and introduction of branchcuts.</div>
<div class="line">R. M. Goldstein, H. A. Zebker and C. L. Werner, Radio Science 23, 713-720</div>
<div class="line">(1988).</div>
<div class="line">Inputs</div>
<div class="line">fase      Phase in radians, wrapped between (-pi,pi)</div>
<div class="line">disp      (optional) = 1 to show progress (will slow down code)</div>
<div class="line">will also display the branch cuts</div>
<div class="line">start     (optional) [y,x] position to start unwrapping. Typically faster</div>
<div class="line">at the center of the array</div>
<div class="line">Outputs</div>
<div class="line">faserecon Unwrapped phase ( = fase where phase could not be unwrapped)</div>
<div class="line">shadow    = 1 where phase could not be unwrapped</div>
<div class="line">31 August, 2010 - Acknowledge if used</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">faserecon shadow</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-identify-system"></span><dl class="function">
<dt id="utils.identify_system">
<code class="descclassname">utils.</code><code class="descname">identify_system</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.identify_system" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Identify the current system to set useful default parameter values in</div>
<div class="line">default_parameter_value.m.</div>
<div class="line">A modified version of both macros at the beginning of the Matlab search</div>
<div class="line">path may be used to define local standard parameters.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">return_system_id_str return_other_system_flags</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imdeform-affine-fft"></span><dl class="function">
<dt id="utils.imdeform_affine_fft">
<code class="descclassname">utils.</code><code class="descname">imdeform_affine_fft</code><span class="sig-paren">(</span><em>img</em>, <em>affine_matrix</em>, <em>linear_shift</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imdeform_affine_fft" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">img = affine_deform_fft(img, affine_matrix, linear_shift)</div>
<div class="line">apply affine deformation on image, use only for small corrections !!</div>
<div class="line">Inputs:</div>
<div class="line">img   -  2D or stack of 2D images</div>
<div class="line">affine_matrix - 2x2xN affine matrix</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imgaussfilt2-fft"></span><dl class="function">
<dt id="utils.imgaussfilt2_fft">
<code class="descclassname">utils.</code><code class="descname">imgaussfilt2_fft</code><span class="sig-paren">(</span><em>A</em>, <em>sigma</em>, <em>split</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imgaussfilt2_fft" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION A = imgaussfilt2_fft(A,sigma, split)</div>
<div class="line">apply fast gaussian smoothing along first two dimensions</div>
<div class="line">split = number of blocks for fft_split</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imgaussfilt3-conv"></span><dl class="function">
<dt id="utils.imgaussfilt3_conv">
<code class="descclassname">utils.</code><code class="descname">imgaussfilt3_conv</code><span class="sig-paren">(</span><em>X</em>, <em>filter_size</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imgaussfilt3_conv" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION A = imgaussfilt3_conv(X, filter_size)</div>
<div class="line">apply gaussian smoothing along all three dimensions, faster than matlab alternative</div>
<div class="line">split = number of blocks for fft_split</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">X</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imgaussfilt3-fft"></span><dl class="function">
<dt id="utils.imgaussfilt3_fft">
<code class="descclassname">utils.</code><code class="descname">imgaussfilt3_fft</code><span class="sig-paren">(</span><em>A</em>, <em>sigma</em>, <em>split</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imgaussfilt3_fft" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION A = imgaussfilt3_fft(A,sigma)</div>
<div class="line">apply gaussian smoothing along all three dimensions, faster than matlab alternative</div>
<div class="line">split = number of blocks for fft_split</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imrescale-fft"></span><dl class="function">
<dt id="utils.imrescale_fft">
<code class="descclassname">utils.</code><code class="descname">imrescale_fft</code><span class="sig-paren">(</span><em>img</em>, <em>scale</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imrescale_fft" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">IMRESCALE_FFT subpixel precision rescaling based on mulitplication by a</div>
<div class="line">matrix of fourier transformation</div>
<div class="line">Inputs:</div>
<div class="line">img   -  2D or stack of 2D images</div>
<div class="line">scale - scaling factor</div>
<div class="line">Outputs: 2D or stack of 2D images scaled by factor scale</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img_rescale</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imrescale-frft"></span><dl class="function">
<dt id="utils.imrescale_frft">
<code class="descclassname">utils.</code><code class="descname">imrescale_frft</code><span class="sig-paren">(</span><em>img</em>, <em>scale_x</em>, <em>scale_y</em>, <em>scale_z</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imrescale_frft" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function img = imrescale_frft(img, scale_x, scale_y, scale_z)</div>
<div class="line">IMRESCALE_FRFT based on fractional fourier transformation</div>
<div class="line">subpixel precision image rescaling</div>
<div class="line">Inputs:</div>
<div class="line">img    2D or stack of 2D images</div>
<div class="line">scale_x - horizontal scaling factor</div>
<div class="line">scale_y - vertical scaling factor, if not provided scale_x is used</div>
<div class="line">Outputs: 2D or stack of 2D images scaled by factors scale_x / scale_y</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imrotate-ax"></span><dl class="function">
<dt id="utils.imrotate_ax">
<code class="descclassname">utils.</code><code class="descname">imrotate_ax</code><span class="sig-paren">(</span><em>img_stack</em>, <em>angle</em>, <em>ax</em>, <em>val</em>, <em>method</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imrotate_ax" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION mg_stack = imrotate_ax(img_stack, angle, ax)</div>
<div class="line">bilinear rotate stack of images along given axis</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img_stack</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imrotate-ax-fft"></span><dl class="function">
<dt id="utils.imrotate_ax_fft">
<code class="descclassname">utils.</code><code class="descname">imrotate_ax_fft</code><span class="sig-paren">(</span><em>img</em>, <em>theta</em>, <em>axis</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imrotate_ax_fft" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION img_stack = imrotate_ax_fft(img_stack, theta, ax)</div>
<div class="line">fft based image rotate for a stack of images along given axis</div>
<div class="line">based on “Fast Fourier method for the accurate rotation of sampled images”, Optic Communications, 1997</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imshear-fft"></span><dl class="function">
<dt id="utils.imshear_fft">
<code class="descclassname">utils.</code><code class="descname">imshear_fft</code><span class="sig-paren">(</span><em>img</em>, <em>theta</em>, <em>shear_axis</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imshear_fft" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION img_stack = imshear_fft(img_stack, theta, ax)</div>
<div class="line">fft based image rotate for a stack of images along given axis</div>
<div class="line">based on “Fast Fourier method for the accurate rotation of sampled images”, Optic Communications, 1997</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imshift-ax"></span><dl class="function">
<dt id="utils.imshift_ax">
<code class="descclassname">utils.</code><code class="descname">imshift_ax</code><span class="sig-paren">(</span><em>img</em>, <em>shift</em>, <em>ax</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imshift_ax" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">IMSHIFT_AX  will apply integer shift that can be different</div>
<div class="line">for each frame along axis AX. If apply_fft == false,</div>
<div class="line">then images will be assumed to be in fourier space</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img_out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imshift-fast"></span><dl class="function">
<dt id="utils.imshift_fast">
<code class="descclassname">utils.</code><code class="descname">imshift_fast</code><span class="sig-paren">(</span><em>img_0</em>, <em>x</em>, <em>y</em>, <em>Npix_new</em>, <em>type</em>, <em>default_val</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imshift_fast" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">IMSHIFT_FAST will shift of stack of images by given number of</div>
<div class="line">pixels and if needed crop / pad image to fit into Npix_new</div>
<div class="line">Parameters:</div>
<div class="line">img_0       - stack of images</div>
<div class="line">x,y         - horizontal / vertical shift in pixels  (scalars)</div>
<div class="line">Npix_new    - empty/missing =&gt; keep original size, 2x1 vector =&gt; embed new image into given frame size</div>
<div class="line">type        - linear / nearest nbr interpolation , (missing = linear)</div>
<div class="line">default_val - default value to fill empty regions created after the image shift</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img_new</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imshift-fft"></span><dl class="function">
<dt id="utils.imshift_fft">
<code class="descclassname">utils.</code><code class="descname">imshift_fft</code><span class="sig-paren">(</span><em>img</em>, <em>x</em>, <em>y</em>, <em>apply_fft</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imshift_fft" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">IMSHIFT_FFT  will apply subpixel shift that can be different for</div>
<div class="line">each frame. If apply_fft == false, then images will be</div>
<div class="line">assumed to be in fourier space</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-imshift-fft-ax"></span><dl class="function">
<dt id="utils.imshift_fft_ax">
<code class="descclassname">utils.</code><code class="descname">imshift_fft_ax</code><span class="sig-paren">(</span><em>img</em>, <em>shift</em>, <em>ax</em>, <em>apply_fft</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.imshift_fft_ax" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">IMSHIFT_FFT_AX  will apply subpixel shift that can be different for each frame along one dimension only</div>
<div class="line">If apply_fft == false, then images will be assumed to be in fourier space</div>
<div class="line">Inputs:</div>
<div class="line">img - inputs ndim array to be shifted along first 2 dimensions</div>
<div class="line">shift - Nx1 vector of shifts, positive direction is up</div>
<div class="line">apply_fft = false - if the img is already after fft, default is false</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-interpolateft"></span><dl class="function">
<dt id="utils.interpolateFT">
<code class="descclassname">utils.</code><code class="descname">interpolateFT</code><span class="sig-paren">(</span><em>im</em>, <em>outsize</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.interpolateFT" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">imout = interpolateFT(im,outsize)</div>
<div class="line">Computes 2D interpolated image using Fourier transform, i.e. dirichlet</div>
<div class="line">interpolation. Computes the FT and then adjusts the size by zero padding</div>
<div class="line">or cropping then it computes the IFT. A real valued input may have</div>
<div class="line">residual imaginary components, which is given by numerical precision of</div>
<div class="line">the FT and IFT.</div>
<div class="line">Inputs</div>
<div class="line">im      - Input complex array</div>
<div class="line">outsize - Output size of array [ny nx]</div>
<div class="line">Outputs</div>
<div class="line">imout   - Output complex image</div>
<div class="line">2014.06.02</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">imout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-interpolateft-ax"></span><dl class="function">
<dt id="utils.interpolateFT_ax">
<code class="descclassname">utils.</code><code class="descname">interpolateFT_ax</code><span class="sig-paren">(</span><em>im</em>, <em>outsize</em>, <em>ax</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.interpolateFT_ax" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">imout = interpolateFT_ax(im,outsize,ax)</div>
<div class="line">Computes interpolated array using 1D Fourier transform, i.e. dirichlet</div>
<div class="line">interpolation along single axis. Computes the FT and then adjusts the size by zero padding</div>
<div class="line">or cropping then it computes the IFT. A real valued input may have</div>
<div class="line">residual imaginary components, which is given by numerical precision of</div>
<div class="line">the FT and IFT.</div>
<div class="line">Inputs</div>
<div class="line">im      - Input complex array</div>
<div class="line">outsize - Output size of array [N pixels]</div>
<div class="line">ax - index of axis along which interpolation is done</div>
</div>
<div class="line-block">
<div class="line">Outputs</div>
<div class="line">imout   - Output complex image</div>
</div>
<div class="line-block">
<div class="line">Example:</div>
<div class="line">x = randn(10,20,30);</div>
<div class="line">x_int = utils.interpolateFT_ax(x, 10, 3) % downsample to 10 pixels along 3rd axis</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">imout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-interpolate-linear"></span><dl class="function">
<dt id="utils.interpolate_linear">
<code class="descclassname">utils.</code><code class="descname">interpolate_linear</code><span class="sig-paren">(</span><em>img</em>, <em>sizeOut</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.interpolate_linear" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function interpolate_linear(img, scale, method)</div>
<div class="line">rescaling based on interp2, faster than utils.interpolateFT, works with GPU</div>
<div class="line">Inputs:</div>
<div class="line">img   -  2D or stack of 2D images</div>
<div class="line">scale - scaling factor</div>
<div class="line">method - linear (default), cubic,</div>
<div class="line">Outputs: 2D or stack of 2D images scaled by factor scale</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img_out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-oncleanup"></span><dl class="function">
<dt id="utils.onCleanup">
<code class="descclassname">utils.</code><code class="descname">onCleanup</code><span class="sig-paren">(</span><em>functionHandle</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.onCleanup" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">ONCLEANUP - modified MATLAB class</div>
</div>
<div class="line-block">
<div class="line">EXAMPLES:</div>
<div class="line">%% cleanup function with no arguments %%</div>
<div class="line">1.) define cleanup routine:</div>
<div class="line">function cleanexit()</div>
<div class="line">fprintf(‘Reconstruction stopped!’)</div>
<div class="line">end</div>
</div>
<div class="line-block">
<div class="line">2.) get instance of onCleanup:</div>
<div class="line">finishup = utils.onCleanup(&#64;() cleanexit());</div>
</div>
<div class="line-block">
<div class="line">%% cleanup function with one or more arguments</div>
<div class="line">1.) define cleanup routine:</div>
<div class="line">function cleanexit(p)</div>
<div class="line">if ~p.getReport.completed</div>
<div class="line">fprintf(‘Reconstruction stopped!’)</div>
<div class="line">end</div>
<div class="line">end</div>
</div>
<div class="line-block">
<div class="line">2.) get instance of onCleanup:</div>
<div class="line">finishup = utils.onCleanup(p, &#64;(x) cleanexit(x));</div>
</div>
<div class="line-block">
<div class="line">3.) if needed, update parameters that are passed to your cleanup</div>
<div class="line">function:</div>
<div class="line">finishup.update(p);</div>
</div>
<div class="line-block">
<div class="line">onCleanup - Specify cleanup work to be done on function completion.</div>
<div class="line">C = onCleanup(S), when called in function F, specifies any cleanup tasks</div>
<div class="line">that need to be performed when F completes.  S is a handle to a function</div>
<div class="line">that performs necessary cleanup work when F exits (e.g., closing files that</div>
<div class="line">have been opened by F).  S will be called whether F exits normally or</div>
<div class="line">because of an error.</div>
</div>
<div class="line-block">
<div class="line">onCleanup is a MATLAB class and C = onCleanup(S) constructs an instance C of</div>
<div class="line">that class.  Whenever an object of this class is explicitly or implicitly</div>
<div class="line">cleared from the workspace, it runs the cleanup function, S.  Objects that</div>
<div class="line">are local variables in a function are implicitly cleared at the termination</div>
<div class="line">of that function.</div>
</div>
<div class="line-block">
<div class="line">Example 1: Use onCleanup to close a file.</div>
</div>
<div class="line-block">
<div class="line">function fileOpenSafely(fileName)</div>
<div class="line">fid = fopen(fileName, ‘w’);</div>
<div class="line">c = onCleanup(&#64;()fclose(fid));</div>
</div>
<div class="line-block">
<div class="line">functionThatMayError(fid);</div>
<div class="line">end   % c will execute fclose(fid) here</div>
</div>
<div class="line-block">
<div class="line">Example 2: Use onCleanup to restore the current directory.</div>
</div>
<div class="line-block">
<div class="line">function changeDirectorySafely(fileName)</div>
<div class="line">currentDir = pwd;</div>
<div class="line">c = onCleanup(&#64;()cd(currentDir));</div>
</div>
<div class="line-block">
<div class="line">functionThatMayError;</div>
<div class="line">end   % c will execute cd(currentDir) here</div>
</div>
<div class="line-block">
<div class="line">See also: CLEAR, CLEARVARS</div>
<div class="line">Reference page in Doc Center</div>
<div class="line">doc utils.onCleanup</div>
</div>
</dd></dl>

<span class="target" id="base-utils-param-protect-field"></span><dl class="function">
<dt id="utils.param_protect_field">
<code class="descclassname">utils.</code><code class="descname">param_protect_field</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.param_protect_field" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">PARAM_PROTECT_FIELD</div>
<div class="line">param_protect_field(param)… check for protected field; returns</div>
<div class="line">boolean</div>
</div>
<div class="line-block">
<div class="line">accepts struct or string as input</div>
</div>
<div class="line-block">
<div class="line">param_protect_field()…    return protected fields</div>
</div>
<div class="line-block">
<div class="line">param_protect_field(param, ‘p’)…  add param to protected fields</div>
</div>
<div class="line-block">
<div class="line">param_protect_field(param, ‘r’)…  remove param from protected fields</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-peakfinder"></span><dl class="function">
<dt id="utils.peakfinder">
<code class="descclassname">utils.</code><code class="descname">peakfinder</code><span class="sig-paren">(</span><em>x0</em>, <em>sel</em>, <em>thresh</em>, <em>extrema</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.peakfinder" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">PEAKFINDER Noise tolerant fast peak finding algorithm</div>
<div class="line">INPUTS:</div>
<div class="line">x0 - A real vector from the maxima will be found (required)</div>
<div class="line">sel - The amount above surrounding data for a peak to be</div>
<div class="line">identified (default = (max(x0)-min(x0))/4). Larger values mean</div>
<div class="line">the algorithm is more selective in finding peaks.</div>
<div class="line">thresh - A threshold value which peaks must be larger than to be</div>
<div class="line">maxima or smaller than to be minima.</div>
<div class="line">extrema - 1 if maxima are desired, -1 if minima are desired</div>
<div class="line">(default = maxima, 1)</div>
<div class="line">OUTPUTS:</div>
<div class="line">peakLoc - The indicies of the identified peaks in x0</div>
<div class="line">peakMag - The magnitude of the identified peaks</div>
</div>
<div class="line-block">
<div class="line">[peakLoc] = peakfinder(x0) returns the indicies of local maxima that</div>
<div class="line">are at least 1/4 the range of the data above surrounding data.</div>
</div>
<div class="line-block">
<div class="line">[peakLoc] = peakfinder(x0,sel) returns the indicies of local maxima</div>
<div class="line">that are at least sel above surrounding data.</div>
</div>
<div class="line-block">
<div class="line">[peakLoc] = peakfinder(x0,sel,thresh) returns the indicies of local</div>
<div class="line">maxima that are at least sel above surrounding data and larger</div>
<div class="line">(smaller) than thresh if you are finding maxima (minima).</div>
</div>
<div class="line-block">
<div class="line">[peakLoc] = peakfinder(x0,sel,thresh,extrema) returns the maxima of the</div>
<div class="line">data if extrema &gt; 0 and the minima of the data if extrema &lt; 0</div>
</div>
<div class="line-block">
<div class="line">[peakLoc, peakMag] = peakfinder(x0,…) returns the indicies of the</div>
<div class="line">local maxima as well as the magnitudes of those maxima</div>
</div>
<div class="line-block">
<div class="line">If called with no output the identified maxima will be plotted along</div>
<div class="line">with the input data.</div>
</div>
<div class="line-block">
<div class="line">Note: If repeated values are found the first is identified as the peak</div>
</div>
<div class="line-block">
<div class="line">Ex:</div>
<div class="line">t = 0:.0001:10;</div>
<div class="line">x = 12*sin(10*2*pi*t)-3*sin(.1*2*pi*t)+randn(1,numel(t));</div>
<div class="line">x(1250:1255) = max(x);</div>
<div class="line">peakfinder(x)</div>
</div>
<div class="line-block">
<div class="line">Copyright Nathanael C. Yoder 2011 (<a class="reference external" href="mailto:nyoder&#37;&#52;&#48;gmail&#46;com">nyoder<span>&#64;</span>gmail<span>&#46;</span>com</a>)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-pixel-to-q"></span><dl class="function">
<dt id="utils.pixel_to_q">
<code class="descclassname">utils.</code><code class="descname">pixel_to_q</code><span class="sig-paren">(</span><em>pixel</em>, <em>pixel_size_mm</em>, <em>det_dist_mm</em>, <em>E_keV</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.pixel_to_q" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Call function without arguments for instructions on how to use it</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">q_A</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-power-spectral-density"></span><dl class="function">
<dt id="utils.power_spectral_density">
<code class="descclassname">utils.</code><code class="descname">power_spectral_density</code><span class="sig-paren">(</span><em>img</em>, <em>air</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.power_spectral_density" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[PSD, freq] = power_spectral_density(img, varargin)</div>
<div class="line">Computes the power spectral density of the provided 3D image.</div>
<div class="line">Can handle non-cube arrays but assumes the voxel is isotropic</div>
</div>
<div class="line-block">
<div class="line">Inputs:</div>
<div class="line">img               input image (2D or 3D)</div>
</div>
<div class="line-block">
<div class="line">Parameters:</div>
<div class="line">thickring         Normally the pixels get assigned to the closest integer pixel ring in Fourier domain.</div>
<div class="line">With thickring the thickness of the rings is increased by</div>
<div class="line">thickring, so each ring gets more pixels and more statistics</div>
<div class="line">auto_binning      apply binning if dimensions are significanlty different along each axis</div>
<div class="line">mask              bool array equal to false for ignored pixels of the fft space</div>
</div>
<div class="line-block">
<div class="line">Outputs:</div>
<div class="line">PSD               PSD curve values</div>
<div class="line">freq              normalized spatial frequencies to 1</div>
</div>
<div class="line-block">
<div class="line">Example of use:</div>
<div class="line">img = randn(512,512,512);</div>
<div class="line">utils.power_spectral_density(img, ‘thickring’, 3);</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">PSD, freq</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-progressbar"></span><dl class="function">
<dt id="utils.progressbar">
<code class="descclassname">utils.</code><code class="descname">progressbar</code><span class="sig-paren">(</span><em>n</em>, <em>N</em>, <em>w</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.progressbar" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">progressbar - display a progress bar</div>
</div>
<div class="line-block">
<div class="line">progressbar(n,N,w);</div>
</div>
<div class="line-block">
<div class="line">displays the progress of n out of N.</div>
<div class="line">n should start at 1.</div>
<div class="line">w is the width of the bar (default w=20).</div>
</div>
</dd></dl>

<span class="target" id="base-utils-prop2focus"></span><dl class="function">
<dt id="utils.prop2focus">
<code class="descclassname">utils.</code><code class="descname">prop2focus</code><span class="sig-paren">(</span><em>img</em>, <em>lam</em>, <em>dx</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.prop2focus" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">PROP2FOCUS propagate img to focus</div>
<div class="line">prop2focus uses ‘phase detection autofocus’ to find the focus</div>
</div>
<div class="line-block">
<div class="line">img…          complex-valued object</div>
<div class="line">lam…          wavelength</div>
<div class="line">dx…           pixel size</div>
</div>
<div class="line-block">
<div class="line">optional parameters</div>
<div class="line">d_start…      initial guess of propagation distance to focus</div>
<div class="line">fov…          crop to fov and apodize edges</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">d, img_prop</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-prop-free-ff"></span><dl class="function">
<dt id="utils.prop_free_ff">
<code class="descclassname">utils.</code><code class="descname">prop_free_ff</code><span class="sig-paren">(</span><em>win</em>, <em>lambda</em>, <em>z</em>, <em>pixsize</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.prop_free_ff" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">PROP_FREE_FF    Far field propagation</div>
</div>
<div class="line-block">
<div class="line">PROP_FREE_FF(WIN, LAMBDA, Z, PIXSIZE) returns the propagated wavefield</div>
<div class="line">WIN by a distance Z, using wavelength LAMBDA. PIXSIZE is the dimension</div>
<div class="line">of one pixel.</div>
</div>
<div class="line-block">
<div class="line">PROP_FREE_FF(WIN, LAMBDA, Z) is the same as above, assuming PIXSIZE=1</div>
<div class="line">(that is, Z and LAMBDA are expressed in pixel units).</div>
</div>
<div class="line-block">
<div class="line">In this implementation, the output wave pixel size becomes</div>
<div class="line">Z*LAMBDA/(N*PIXSIZE) (where N is the linear dimension of the array).</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">wout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-prop-free-nf"></span><dl class="function">
<dt id="utils.prop_free_nf">
<code class="descclassname">utils.</code><code class="descname">prop_free_nf</code><span class="sig-paren">(</span><em>win</em>, <em>lambda</em>, <em>z</em>, <em>dx</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.prop_free_nf" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">PROP_FREE_NF    Near field propagation</div>
</div>
<div class="line-block">
<div class="line">wout = prop_free_nf(win, lambda, z, pixsize) returns the propagated wavefield</div>
<div class="line">WIN by a distance Z, using wavelength LAMBDA. PIXSIZE is the dimension</div>
<div class="line">of one pixel.</div>
</div>
<div class="line-block">
<div class="line">wout = prop_free_nf(win, lambda, z) is the same as above, assuming PIXSIZE=1</div>
<div class="line">(that is, Z and LAMBDA are expressed in pixel units).</div>
</div>
<div class="line-block">
<div class="line">[~,H] = prop_free_nf(win, lambda, z, pixsize)    Does not compute propagation only</div>
<div class="line">computes and returns H, the Fourier domain propagation function</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">wout, H</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-pshift"></span><dl class="function">
<dt id="utils.pshift">
<code class="descclassname">utils.</code><code class="descname">pshift</code><span class="sig-paren">(</span><em>ain</em>, <em>ctrpos</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.pshift" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">AOUT = pshift(AIN, CTRPOS)</div>
</div>
<div class="line-block">
<div class="line">Shift array AIN periodically so that CTRPOS is placed at (1,1).</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">aout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-registersubimages-2"></span><dl class="function">
<dt id="utils.registersubimages_2">
<code class="descclassname">utils.</code><code class="descname">registersubimages_2</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em>, <em>upsamp</em>, <em>displ</em>, <em>Wfilt</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.registersubimages_2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Finds common subregions in img1 and img2 and computes registration (alignment)</div>
<div class="line">Does not perform global search, so an approximate initial estimate is</div>
<div class="line">necessary</div>
</div>
<div class="line-block">
<div class="line">[subim1, subim2, delta, deltafine,regionsout] = registersubimages_2(img1, img2, x1, y1, x2, y2, upsamp, displ,Wfilt);</div>
</div>
<div class="line-block">
<div class="line">Inputs</div>
<div class="line">img1 -    Reference image</div>
<div class="line">x1, y1 -  Vectors indicating the region of interest of img1, e.g. x1 =</div>
<div class="line">[30:100]. If left empty the code starts with full window and</div>
<div class="line">then reduces to the common part</div>
<div class="line">img2, x2, y2 -    Same as 1 but for the image to align</div>
<div class="line">upsamp -  Fraction of a pixel for the fine search, default = 1</div>
<div class="line">displ     = 0  no information displayed (default)</div>
<div class="line">= 1  to display text information</div>
<div class="line">&gt; 1  also shows images in figure(display)</div>
<div class="line">Wfilt     Fourier domain filter for registration (= 1 for no effect)</div>
</div>
<div class="line-block">
<div class="line">Outputs</div>
<div class="line">subim1, subim2 -  Common subimages taken from img1 and img2, subim2 is realigned subpixel</div>
<div class="line">delta          -  Registration values (dy,dx)</div>
<div class="line">deltafine      -  Only the subpixel components of the alignment</div>
<div class="line">regionsout     -  Structure with final regions for registration</div>
</div>
<div class="line-block">
<div class="line">Please cite and acknowledge if you use it. Algorithm extended from that in</div>
<div class="line">M. Guizar-Sicairos, S. T. Thurman and J. R. Fienup, “Efficient subpixel</div>
<div class="line">image registration algorithms,” Opt. Lett. 33, 156 (2008).</div>
</div>
<div class="line-block">
<div class="line">Report bugs to <a class="reference external" href="mailto:mguizar&#37;&#52;&#48;gmail&#46;com">mguizar<span>&#64;</span>gmail<span>&#46;</span>com</a></div>
</div>
<div class="line-block">
<div class="line">This code is intended for finding the same object in two different</div>
<div class="line">images. It is a local search, so the code will go with the first solution</div>
<div class="line">it finds, an approximately good initial estimate is required.</div>
</div>
<div class="line-block">
<div class="line">This code uses integer pixel and subpixel cross-correlation to find the</div>
<div class="line">local solution. The intended purpose is for this code to be able to find</div>
<div class="line">two similar subimages in the same image so the global search would be</div>
<div class="line">inadequate. This code does not remove the global phase between the</div>
<div class="line">subimages.</div>
</div>
<div class="line-block">
<div class="line">Keep your eyes open, this code has not been throughly debugged or tested</div>
</div>
<div class="line-block">
<div class="line">History</div>
</div>
<div class="line-block">
<div class="line">Allow for iterative refinement of chosen subwindow</div>
<div class="line">Allow for empty input for subwindow regions</div>
<div class="line">Manuel Guizar - January 22, 2013</div>
</div>
<div class="line-block">
<div class="line">Modified on 24 Aug 2010 to return deltafine and receive a Fourier filter</div>
<div class="line">Also modified to have initial estimate with upsamp 2 and then round and</div>
<div class="line">so that the final registration is done with an upsam accuracy</div>
</div>
<div class="line-block">
<div class="line">Modified on 25 Aug 2010. If coarse alignment exceeds image dimensions</div>
<div class="line">assume error in coarse alignment and perform only subpixel.</div>
</div>
<div class="line-block">
<div class="line">Original code by Manuel Guizar - August 4, 2009</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">subim1, subim2, delta, deltafine, regionsout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-relative-path"></span><dl class="function">
<dt id="utils.relative_path">
<code class="descclassname">utils.</code><code class="descname">relative_path</code><span class="sig-paren">(</span><em>path1</em>, <em>path2</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.relative_path" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">RELATIVE_PATH returns relative path from absolute path &lt;path1&gt; to &lt;path2&gt;</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">rel_path</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-remove-linear-phase-smart"></span><dl class="function">
<dt id="utils.remove_linear_phase_smart">
<code class="descclassname">utils.</code><code class="descname">remove_linear_phase_smart</code><span class="sig-paren">(</span><em>im</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.remove_linear_phase_smart" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">im_output = remove_linear_phase_smart(im_input, [,&lt;name&gt;,&lt;value&gt;] …])</div>
</div>
<div class="line-block">
<div class="line">Receives a complex valued array, returns the complex array after removing</div>
<div class="line">the linear and the constant phase offset. Different options are given for</div>
<div class="line">defining a reference area on the sample</div>
</div>
<div class="line-block">
<div class="line">im_input  Input complex valued image</div>
</div>
<div class="line-block">
<div class="line">The optional &lt;name&gt;,&lt;value&gt; pairs are:</div>
</div>
<div class="line-block">
<div class="line">‘mask’, maskarray     Binary array with ones where the linear phase should be</div>
<div class="line">removed. Alternatively the mask can be an array of</div>
<div class="line">non unitary weights for the computation of average</div>
<div class="line">phase ramp and average phase. For example, the</div>
<div class="line">magnitude can be use to weight</div>
</div>
<div class="line-block">
<div class="line">June 21,2016</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">im_output, ph_err</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-remove-linearphase"></span><dl class="function">
<dt id="utils.remove_linearphase">
<code class="descclassname">utils.</code><code class="descname">remove_linearphase</code><span class="sig-paren">(</span><em>testim</em>, <em>mask</em>, <em>upsamp</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.remove_linearphase" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Removes linear phase from object considering only pixels where mask is</div>
<div class="line">unity, arrays have center on center of array</div>
</div>
<div class="line-block">
<div class="line">testim    Image</div>
<div class="line">mask      Binary array with ones where the linear phase should be</div>
<div class="line">computed from</div>
<div class="line">upsamp    Linear phase will be removed within 2*pi/upsamp peak to valley</div>
<div class="line">in radians</div>
<div class="line">errorm    Optional ouput with NRMS</div>
</div>
<div class="line-block">
<div class="line">August 19 2010</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">output errorm</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-remove-linearphase-v2"></span><dl class="function">
<dt id="utils.remove_linearphase_v2">
<code class="descclassname">utils.</code><code class="descname">remove_linearphase_v2</code><span class="sig-paren">(</span><em>testim</em>, <em>mask</em>, <em>upsamp</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.remove_linearphase_v2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[output errorm] = remove_linearphase_v2(testim,mask,upsamp)</div>
<div class="line">Removes linear phase from object considering only pixels where mask is</div>
<div class="line">unity, arrays have center on center of array</div>
</div>
<div class="line-block">
<div class="line">testim    Image</div>
<div class="line">mask      Binary array with ones where the linear phase should be</div>
<div class="line">computed from</div>
<div class="line">upsamp    Linear phase will be removed within 2*pi/upsamp peak to valley</div>
<div class="line">in radians</div>
<div class="line">errorm    Optional ouput with all outputs from dftregistration</div>
</div>
<div class="line-block">
<div class="line">August 19 2010</div>
<div class="line">Updated on Feb 18 2011, to return all outputs from dftregistration</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">output errorm</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-remove-sinogram-ramp"></span><dl class="function">
<dt id="utils.remove_sinogram_ramp">
<code class="descclassname">utils.</code><code class="descname">remove_sinogram_ramp</code><span class="sig-paren">(</span><em>sinogram</em>, <em>air_gap</em>, <em>polyfit_order</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.remove_sinogram_ramp" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">sinogram = remove_sinogram_ramp(sinogram,air_gap,polyfit_order )</div>
<div class="line">FUNCTION simple and fast phase ramp/offset removal from already unwrapped sinogram</div>
<div class="line">using linear interpolation between air on both sides</div>
<div class="line">Inputs:</div>
<div class="line">sinogram - unwrapped projections</div>
<div class="line">air_gap = [2x1] vector with number of pixels on both sides where can</div>
<div class="line">be assumed to be air</div>
<div class="line">polyfit_order - -1 = dont assume anything about the removed phase</div>
<div class="line">0 = assume that it is constant offset</div>
<div class="line">1 = assume that it is 2D plane</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sinogram</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-rmphaseramp"></span><dl class="function">
<dt id="utils.rmphaseramp">
<code class="descclassname">utils.</code><code class="descname">rmphaseramp</code><span class="sig-paren">(</span><em>a</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.rmphaseramp" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Function [A1, P] = RMPHASERAMP(A)</div>
</div>
<div class="line-block">
<div class="line">A1 = RMPHASERAMP(A)</div>
<div class="line">Removes the phase ramp from the image A.</div>
</div>
<div class="line-block">
<div class="line">[A1, P] = RMPHASERAMP(A)</div>
</div>
<div class="line-block">
<div class="line">such that A1 = A.* P.</div>
</div>
<div class="line-block">
<div class="line">… = RMPHASERAMP(A, M)</div>
<div class="line">Uses M as a mask.</div>
</div>
<div class="line-block">
<div class="line">… = RMPHASERAMP(A, ‘abs’)</div>
<div class="line">Uses the absolute value of A as a weight.</div>
</div>
<div class="line-block">
<div class="line">… = RMPHASERAMP(A, ‘roi’)</div>
<div class="line">Prompts user to select a polygonal mask to define flat phase.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">b, p, varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-savefast-safe"></span><dl class="function">
<dt id="utils.savefast_safe">
<code class="descclassname">utils.</code><code class="descname">savefast_safe</code><span class="sig-paren">(</span><em>filename</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.savefast_safe" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION savefast_safe(filename, varargin)</div>
<div class="line">savefast: fast saves of large arrays to .mat files</div>
</div>
<div class="line-block">
<div class="line">Matlab’s ‘save’ command can be very slow when saving large arrays,</div>
<div class="line">because by default Matlab attempts to use compression. This function</div>
<div class="line">provides a much faster alternative, at the cost of larger files.</div>
</div>
<div class="line-block">
<div class="line">The syntax is identical to that of the Matlab save command.</div>
</div>
<div class="line-block">
<div class="line">Example:</div>
<div class="line">&gt;&gt; ops = struct(‘algorithm’, ‘greedy’);</div>
<div class="line">&gt;&gt; A = int32(randi(20, 1000, 1200, 40));</div>
<div class="line">&gt;&gt; B = randn(500, 1800, 60);</div>
<div class="line">&gt;&gt; tic; save /tmp/test ops A B; toc</div>
<div class="line">Elapsed time is 22.980294 seconds.</div>
<div class="line">&gt;&gt; tic; savefast /tmp/test ops A B; toc</div>
<div class="line">Elapsed time is 0.571098 seconds.</div>
</div>
</dd></dl>

<span class="target" id="base-utils-sbb"></span><dl class="function">
<dt id="utils.sbb">
<code class="descclassname">utils.</code><code class="descname">sbb</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.sbb" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">SBB returns station board for PSI West</div>
</div>
<div class="line-block">
<div class="line">syntax:</div>
<div class="line">as station board:</div>
<div class="line">sbb (from, number_of_connections)</div>
<div class="line">as connection finder:</div>
<div class="line">sbb (from, to, number_of_connections)</div>
</div>
<div class="line-block">
<div class="line">03/2017</div>
</div>
</dd></dl>

<span class="target" id="base-utils-shiftpp2"></span><dl class="function">
<dt id="utils.shiftpp2">
<code class="descclassname">utils.</code><code class="descname">shiftpp2</code><span class="sig-paren">(</span><em>rows*Nr/nr+cols*Nc/nc</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.shiftpp2" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">function out=shiftpp(in,rows,cols)</div>
<div class="line">performs partial-pixel shift (with wraparound) using FFT</div>
<div class="line">Modified from shiftpp.m to correct a phase factor that appeared when using</div>
<div class="line">odd sized arrays.</div>
<div class="line">Manuel Guizar - Dec 13, 2007</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Nc, Nr</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-shiftwrapbilinear"></span><dl class="function">
<dt id="utils.shiftwrapbilinear">
<code class="descclassname">utils.</code><code class="descname">shiftwrapbilinear</code><span class="sig-paren">(</span><em>in</em>, <em>dy</em>, <em>dx</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.shiftwrapbilinear" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">out = shiftwraplinear(in,dy,dx)</div>
<div class="line">Shifts an image with wrap around and bilinear interpolation</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-smooth-edges"></span><dl class="function">
<dt id="utils.smooth_edges">
<code class="descclassname">utils.</code><code class="descname">smooth_edges</code><span class="sig-paren">(</span><em>img</em>, <em>win_size</em>, <em>dims</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.smooth_edges" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">FUNCTION img = smooth_edges(img, win_size)</div>
<div class="line">takes stack of 2D images and smooths boundaries to avoid sharp edge artefacts during imshift_fft</div>
<div class="line">Inputs:</div>
<div class="line">img - 2D / 3D array, smoothing is done along first two dimensions</div>
<div class="line">win_size - size of the smoothing region, default is 3</div>
<div class="line">dims - list of dimensions along which will by smoothing done</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-stabilize-phase"></span><dl class="function">
<dt id="utils.stabilize_phase">
<code class="descclassname">utils.</code><code class="descname">stabilize_phase</code><span class="sig-paren">(</span><em>img</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.stabilize_phase" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">[img, gamma,gamma_x, gamma_y, c_offset] = stabilize_phase(img, varargin)</div>
<div class="line">Description:  adjust phase of the object to be mostly around zero and</div>
<div class="line">remove linear ramp</div>
<div class="line">Inputs:</div>
<div class="line">img - complex image to stabilize</div>
<div class="line">img_ref - complex images used as reference, if empty ones is used</div>
<div class="line">Varargins:</div>
<div class="line">weights  - 0&lt;x&lt;1 numeric array denoting reliable unwrapping region</div>
<div class="line">split  - split FFTon smaller blocks on GPU</div>
<div class="line">fourier_guess - (bool), use maximum in Fourier space to get initial</div>
<div class="line">guess of the phase ramp</div>
<div class="line">remove_ramp - (bool), if false, remove only phase offset (scalar)</div>
<div class="line">smoothing - smooth image before removing ramp, makes it more robust</div>
<div class="line">Outputs:</div>
<div class="line">img - phase ramp / offset subtracted complex-valued image</div>
<div class="line">gamma,gamma_x, gamma_y - (1,1,N arrays) offset, ramp horizontal / vertical</div>
<div class="line">c_offset - either constant or phase ramp offset subtracted from the</div>
<div class="line">complex data as img .* exp(1i*c_offset)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">img, gamma, gamma_x, gamma_y, c_offset</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-struc2cell"></span><dl class="function">
<dt id="utils.struc2cell">
<code class="descclassname">utils.</code><code class="descname">struc2cell</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.struc2cell" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">STRUC2CELL recursively converts a structure into a cell</div>
</div>
<div class="line-block">
<div class="line">EXAMPLE:</div>
</div>
<div class="line-block">
<div class="line">Define structure:</div>
<div class="line">p = [];</div>
<div class="line">p.verbose_level = 2;</div>
<div class="line">p.energy = 6.2;</div>
<div class="line">p.engines.engine0.name = ‘DM’;</div>
<div class="line">p.engines.engine0.iter = 200;</div>
</div>
<div class="line-block">
<div class="line">Convert to cell:</div>
<div class="line">fn = struc2cell(p)</div>
</div>
<div class="line-block">
<div class="line">Output:</div>
<div class="line">1×4 cell array</div>
<div class="line">‘verbose_level’  ‘energy’  ‘engines.engine0.name’  ‘engines.engine0.iter’</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">entry</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-update-param"></span><dl class="function">
<dt id="utils.update_param">
<code class="descclassname">utils.</code><code class="descname">update_param</code><span class="sig-paren">(</span><em>p</em>, <em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.update_param" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">UPDATE_PARAM Use update_param to update a struct with another struct and /</div>
<div class="line">or fields and their corresponding values.</div>
</div>
<div class="line-block">
<div class="line">Update struct with another struct:</div>
<div class="line">p = update_param(p, p_updated);</div>
</div>
<div class="line-block">
<div class="line">Update struct with another struct and fields:</div>
<div class="line">p = update_param(p, p_updated, ‘windowautopos’, 1, ‘extrastringtitle’, ‘Final recon’);</div>
</div>
<div class="line-block">
<div class="line">Update struct with fields:</div>
<div class="line">p = update_param(p, ‘windowautopos’, 1, ‘extrastringtitle’,’Final recon’);</div>
</div>
<div class="line-block">
<div class="line">Use field force_update to select different update types:</div>
<div class="line">force_update = 0 …        add fields but don’t overwrite them</div>
<div class="line">force_update = 1 …        overwrite fields but leave protected</div>
<div class="line">fields unchanged (default)</div>
<div class="line">force_update = 2 …        overwrite everything</div>
</div>
<div class="line-block">
<div class="line">p = update_param(p, ‘windowautopos’, 1, ‘force_update’, 0);</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">p</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="base-utils-verbose"></span><dl class="function">
<dt id="utils.verbose">
<code class="descclassname">utils.</code><code class="descname">verbose</code><span class="sig-paren">(</span><em>varargin</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.verbose" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Function verbose(level, message)</div>
</div>
<div class="line-block">
<div class="line">verbose : shows current verbose level</div>
<div class="line">verbose(n): set the level to n</div>
<div class="line">verbose(n, message): displays the message if n &lt;= current verbose level</div>
</div>
<div class="line-block">
<div class="line">verbose(n, message, v1, v2, …) behaves like sprintf(message, v1, v2, …)</div>
</div>
<div class="line-block">
<div class="line">Suggested levels:</div>
<div class="line">1: important information</div>
<div class="line">2: general information</div>
<div class="line">3: debugging</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="utils-private">
<h3>+utils/private<a class="headerlink" href="#utils-private" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="trash">
<h2>trash<a class="headerlink" href="#trash" title="Permalink to this headline">¶</a></h2>
<span class="target" id="base-trash-create-mask-gui"></span><dl class="function">
<dt>
<code class="descname">trash/create_mask_GUI(varargin)</code></dt>
<dd><div class="line-block">
<div class="line">CREATE_MASK_GUI MATLAB code for create_mask_GUI.fig</div>
<div class="line">CREATE_MASK_GUI, by itself, creates a new CREATE_MASK_GUI or raises the existing</div>
<div class="line">singleton*.</div>
</div>
<div class="line-block">
<div class="line">H = CREATE_MASK_GUI returns the handle to a new CREATE_MASK_GUI or the handle to</div>
<div class="line">the existing singleton*.</div>
</div>
<div class="line-block">
<div class="line">CREATE_MASK_GUI(‘CALLBACK’,hObject,eventData,handles,…) calls the local</div>
<div class="line">function named CALLBACK in CREATE_MASK_GUI.M with the given input arguments.</div>
</div>
<div class="line-block">
<div class="line">CREATE_MASK_GUI(‘Property’,’Value’,…) creates a new CREATE_MASK_GUI or raises the</div>
<div class="line">existing singleton*.  Starting from the left, property value pairs are</div>
<div class="line">applied to the GUI before create_mask_GUI_OpeningFcn gets called.  An</div>
<div class="line">unrecognized property name or invalid value makes property application</div>
<div class="line">stop.  All inputs are passed to create_mask_GUI_OpeningFcn via varargin.</div>
</div>
<div class="line-block">
<div class="line"><a href="#id11"><span class="problematic" id="id12">*</span></a>See GUI Options on GUIDE’s Tools menu.  Choose “GUI allows only one</div>
<div class="line">instance to run (singleton)”.</div>
</div>
<div class="line-block">
<div class="line">See also: GUIDE, GUIDATA, GUIHANDLES</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varargout</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="object">
<dt>
<code class="descname">create_mask_GUI_export_backup</code></dt>
<dd><div class="line-block">
<div class="line">CREATE_MASK_GUI_EXPORT MATLAB code for create_mask_GUI_export.fig</div>
<div class="line">CREATE_MASK_GUI_EXPORT, by itself, creates a new CREATE_MASK_GUI_EXPORT or raises the existing</div>
<div class="line">singleton*.</div>
</div>
<div class="line-block">
<div class="line">H = CREATE_MASK_GUI_EXPORT returns the handle to a new CREATE_MASK_GUI_EXPORT or the handle to</div>
<div class="line">the existing singleton*.</div>
</div>
<div class="line-block">
<div class="line">CREATE_MASK_GUI_EXPORT(‘CALLBACK’,hObject,eventData,handles,…) calls the local</div>
<div class="line">function named CALLBACK in CREATE_MASK_GUI_EXPORT.M with the given input arguments.</div>
</div>
<div class="line-block">
<div class="line">CREATE_MASK_GUI_EXPORT(‘Property’,’Value’,…) creates a new CREATE_MASK_GUI_EXPORT or raises the</div>
<div class="line">existing singleton*.  Starting from the left, property value pairs are</div>
<div class="line">applied to the GUI before create_mask_GUI_export_OpeningFcn gets called.  An</div>
<div class="line">unrecognized property name or invalid value makes property application</div>
<div class="line">stop.  All inputs are passed to create_mask_GUI_export_OpeningFcn via varargin.</div>
</div>
<div class="line-block">
<div class="line"><a href="#id13"><span class="problematic" id="id14">*</span></a>See GUI Options on GUIDE’s Tools menu.  Choose “GUI allows only one</div>
<div class="line">instance to run (singleton)”.</div>
</div>
<div class="line-block">
<div class="line">See also: GUIDE, GUIDATA, GUIHANDLES</div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ptycho_func_doc.html" class="btn btn-neutral float-right" title="ptycho package documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="new_beamline.html" class="btn btn-neutral" title="How to add support for a beamline" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CXS group.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>